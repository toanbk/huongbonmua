/*! For license information please see chatbot.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={469:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>ChatbotContextProvider,o:()=>useChatbotContext});var _neko_ui__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(296),_app_chatbot_helpers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(966),_app_chatbot_MwaiAPI__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(137),_app_helpers__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(678);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var _excluded=["children"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),s=new C(n||[]);return o(i,"_invoke",{value:O(e,r,s)}),i}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",m="executing",h="completed",y={};function v(){}function g(){}function b(){}var _={};u(_,i,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(T([])));S&&S!==r&&n.call(S,i)&&(_=S);var x=b.prototype=v.prototype=Object.create(_);function E(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(o,a,i,s){var c=p(e[o],e,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_typeof(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=f;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=I(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=p(t,r,n);if("normal"===u.type){if(o=n.done?h:d,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=h,n.method="throw",n.arg=u.arg)}}}function I(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var a=p(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,y;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function T(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return g.prototype=b,o(x,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},E(k.prototype),u(k.prototype,s,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(l(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(x),u(x,c,"Generator"),u(x,i,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=T,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:T(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){asyncGeneratorStep(a,n,o,i,s,"next",e)}function s(e){asyncGeneratorStep(a,n,o,i,s,"throw",e)}i(void 0)}))}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}var _wp$element=wp.element,useContext=_wp$element.useContext,createContext=_wp$element.createContext,useState=_wp$element.useState,useMemo=_wp$element.useMemo,useEffect=_wp$element.useEffect,useCallback=_wp$element.useCallback,useRef=_wp$element.useRef,rawAiName="AI: ",rawUserName="User: ",ChatbotContext=createContext(),useChatbotContext=function(){var e=useContext(ChatbotContext);if(!e)throw new Error("useChatbotContext must be used within a ChatbotContextProvider");return e},ChatbotContextProvider=function ChatbotContextProvider(_ref){var _system$typewriter,_system$speech_recogn,_system$speech_synthe,_params$startSentence,_params$startSentence2,children=_ref.children,rest=_objectWithoutProperties(_ref,_excluded),params=rest.params,system=rest.system,theme=rest.theme,atts=rest.atts,_useChrono=(0,_app_chatbot_helpers__WEBPACK_IMPORTED_MODULE_0__.dh)(),timeElapsed=_useChrono.timeElapsed,startChrono=_useChrono.startChrono,stopChrono=_useChrono.stopChrono,shortcodeStyles=useMemo((function(){return(null==theme?void 0:theme.settings)||{}}),[theme]),_useState=useState(system.restNonce),_useState2=_slicedToArray(_useState,2),restNonce=_useState2[0],setRestNonce=_useState2[1],_useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1],_useState5=useState([]),_useState6=_slicedToArray(_useState5,2),shortcuts=_useState6[0],setShortcuts=_useState6[1],_useState7=useState([]),_useState8=_slicedToArray(_useState7,2),blocks=_useState8[0],setBlocks=_useState8[1],_useState9=useState(!1),_useState10=_slicedToArray(_useState9,2),locked=_useState10[0],setLocked=_useState10[1],_useState11=useState((0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.vx)()),_useState12=_slicedToArray(_useState11,2),chatId=_useState12[0],setChatId=_useState12[1],_useState13=useState(""),_useState14=_slicedToArray(_useState13,2),inputText=_useState14[0],setInputText=_useState14[1],_useState15=useState(!1),_useState16=_slicedToArray(_useState15,2),chatbotTriggered=_useState16[0],setChatbotTriggered=_useState16[1],_useState17=useState(!1),_useState18=_slicedToArray(_useState17,2),showIconMessage=_useState18[0],setShowIconMessage=_useState18[1],_useState19=useState({localFile:null,uploadedId:null,uploadedUrl:null,uploadProgress:null}),_useState20=_slicedToArray(_useState19,2),uploadedFile=_useState20[0],setUploadedFile=_useState20[1],_useState21=useState(!0),_useState22=_slicedToArray(_useState21,2),windowed=_useState22[0],setWindowed=_useState22[1],_useState23=useState(!1),_useState24=_slicedToArray(_useState23,2),open=_useState24[0],setOpen=_useState24[1],_useState25=useState(null),_useState26=_slicedToArray(_useState25,2),error=_useState26[0],setError=_useState26[1],_useState27=useState(!1),_useState28=_slicedToArray(_useState27,2),busy=_useState28[0],setBusy=_useState28[1],_useState29=useState(!1),_useState30=_slicedToArray(_useState29,2),busyNonce=_useState30[0],setBusyNonce=_useState30[1],_useState31=useState(),_useState32=_slicedToArray(_useState31,2),serverReply=_useState32[0],setServerReply=_useState32[1],chatbotInputRef=useRef(),conversationRef=useRef(),hasFocusRef=useRef(!1),_useSpeechRecognition=(0,_app_chatbot_helpers__WEBPACK_IMPORTED_MODULE_0__.Vw)((function(e){setInputText(e)})),isListening=_useSpeechRecognition.isListening,setIsListening=_useSpeechRecognition.setIsListening,speechRecognitionAvailable=_useSpeechRecognition.speechRecognitionAvailable,stream=system.stream||!1,internalId=useMemo((function(){return(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.vx)()}),[]),botId=system.botId,customId=system.customId,userData=system.userData,sessionId=system.sessionId,contextId=system.contextId,pluginUrl=system.pluginUrl,restUrl=system.restUrl,debugMode=system.debugMode,virtualKeyboardFix=system.virtual_keyboard_fix,typewriter=null!==(_system$typewriter=null==system?void 0:system.typewriter)&&void 0!==_system$typewriter&&_system$typewriter,speechRecognition=null!==(_system$speech_recogn=null==system?void 0:system.speech_recognition)&&void 0!==_system$speech_recogn&&_system$speech_recogn,speechSynthesis=null!==(_system$speech_synthe=null==system?void 0:system.speech_synthesis)&&void 0!==_system$speech_synthe&&_system$speech_synthe,startSentence=null!==(_params$startSentence=null===(_params$startSentence2=params.startSentence)||void 0===_params$startSentence2?void 0:_params$startSentence2.trim())&&void 0!==_params$startSentence?_params$startSentence:"",initialActions=system.actions||[],initialShortcuts=system.shortcuts||[],initialBlocks=system.blocks||[],isMobile=document.innerWidth<=768,processedParams=(0,_app_chatbot_helpers__WEBPACK_IMPORTED_MODULE_0__._$)(params),aiName=processedParams.aiName,userName=processedParams.userName,guestName=processedParams.guestName,aiAvatar=processedParams.aiAvatar,userAvatar=processedParams.userAvatar,guestAvatar=processedParams.guestAvatar,textSend=processedParams.textSend,textClear=processedParams.textClear,textInputMaxLength=processedParams.textInputMaxLength,textInputPlaceholder=processedParams.textInputPlaceholder,textCompliance=processedParams.textCompliance,isWindow=processedParams.window,copyButton=processedParams.copyButton,fullscreen=processedParams.fullscreen,localMemoryParam=processedParams.localMemory,icon=processedParams.icon,iconText=processedParams.iconText,iconTextDelay=processedParams.iconTextDelay,iconAlt=processedParams.iconAlt,iconPosition=processedParams.iconPosition,iconBubble=processedParams.iconBubble,imageUpload=processedParams.imageUpload,fileSearch=processedParams.fileSearch,localMemory=localMemoryParam&&(!!customId||!!botId),localStorageKey=localMemory?"mwai-chat-".concat(customId||botId):null,_useMemo=useMemo((function(){var e=function(e){return e?(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.Ve)(e)||(0,_app_chatbot_helpers__WEBPACK_IMPORTED_MODULE_0__.mv)(e)?e:"".concat(pluginUrl,"/images/").concat(e):null},t=icon?e(icon):"".concat(pluginUrl,"/images/chat-traditional-1.svg"),r=e(processedParams.aiAvatarUrl),n=e(processedParams.userAvatarUrl),o=e(processedParams.guestAvatarUrl);return{cssVariables:Object.keys(shortcodeStyles).reduce((function(e,t){return e["--mwai-".concat(t)]=shortcodeStyles[t],e}),{}),iconUrl:t,aiAvatarUrl:r,userAvatarUrl:n,guestAvatarUrl:o}}),[icon,pluginUrl,shortcodeStyles,processedParams]),cssVariables=_useMemo.cssVariables,iconUrl=_useMemo.iconUrl,aiAvatarUrl=_useMemo.aiAvatarUrl,userAvatarUrl=_useMemo.userAvatarUrl,guestAvatarUrl=_useMemo.guestAvatarUrl,_useState33=useState(!1),_useState34=_slicedToArray(_useState33,2),draggingType=_useState34[0],setDraggingType=_useState34[1],_useState35=useState(!1),_useState36=_slicedToArray(_useState35,2),isBlocked=_useState36[0],setIsBlocked=_useState36[1],uploadIconPosition=useMemo((function(){return"timeless"===(null==theme?void 0:theme.themeId)?"mwai-tools":"mwai-input"}),[null==theme?void 0:theme.themeId]),submitButtonConf=useMemo((function(){return{text:textSend,textSend,textClear,imageSend:"timeless"===(null==theme?void 0:theme.themeId)?pluginUrl+"/images/action-submit-blue.svg":null,imageClear:"timeless"===(null==theme?void 0:theme.themeId)?pluginUrl+"/images/action-clear-blue.svg":null}}),[pluginUrl,textClear,textSend,null==theme?void 0:theme.themeId]),resetMessages=function(){if(resetUploadedFile(),startSentence){var e=[{id:(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.vx)(),role:"assistant",content:startSentence,who:rawAiName,timestamp:(new Date).getTime()}];setMessages(e)}else setMessages([])},refreshRestNonce=useCallback(_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,n,o=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]&&o[0],e.prev=1,t||!restNonce){e.next=4;break}return e.abrupt("return",restNonce);case 4:return setBusyNonce(!0),e.next=7,(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.ti)("".concat(restUrl,"/mwai/v1/start_session"));case 7:return r=e.sent,e.next=10,r.json();case 10:return n=e.sent,setRestNonce(n.restNonce),e.abrupt("return",n.restNonce);case 15:e.prev=15,e.t0=e.catch(1),console.error("Error while fetching the restNonce.",e.t0);case 18:return e.prev=18,setBusyNonce(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,15,18,21]])}))),[restNonce,setRestNonce,restUrl]);useEffect((function(){initialActions.length>0&&handleActions(initialActions),initialShortcuts.length>0&&handleShortcuts(initialShortcuts),initialBlocks.length>0&&handleBlocks(initialBlocks)}),[]),useEffect((function(){chatbotTriggered&&!restNonce&&refreshRestNonce()}),[chatbotTriggered]),useEffect((function(){inputText.length>0&&!chatbotTriggered&&setChatbotTriggered(!0)}),[chatbotTriggered,inputText]),useEffect((function(){resetMessages()}),[startSentence]),useEffect((function(){if(customId||botId){var e=_app_chatbot_MwaiAPI__WEBPACK_IMPORTED_MODULE_2__.HX.chatbots.findIndex((function(e){return e.internalId===internalId})),t={internalId,botId,chatId,customId,open:function(){setTasks((function(e){return[].concat(_toConsumableArray(e),[{action:"open"}])}))},close:function(){setTasks((function(e){return[].concat(_toConsumableArray(e),[{action:"close"}])}))},clear:function(){setTasks((function(e){return[].concat(_toConsumableArray(e),[{action:"clear"}])}))},toggle:function(){setTasks((function(e){return[].concat(_toConsumableArray(e),[{action:"toggle"}])}))},ask:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];setTasks((function(r){return[].concat(_toConsumableArray(r),[{action:"ask",data:{text:e,submit:t}}])}))},lock:function(){setLocked(!0)},unlock:function(){setLocked(!1)},setShortcuts:function(e){setTasks((function(t){return[].concat(_toConsumableArray(t),[{action:"setShortcuts",data:e}])}))},setBlocks:function(e){setTasks((function(t){return[].concat(_toConsumableArray(t),[{action:"setBlocks",data:e}])}))},setContext:function(e){var t=e.chatId,r=e.messages;setTasks((function(e){return[].concat(_toConsumableArray(e),[{action:"setContext",data:{chatId:t,messages:r}}])}))}};-1!==e?_app_chatbot_MwaiAPI__WEBPACK_IMPORTED_MODULE_2__.HX.chatbots[e]=t:_app_chatbot_MwaiAPI__WEBPACK_IMPORTED_MODULE_2__.HX.chatbots.push(t)}}),[botId,chatId,customId,internalId]),useEffect((function(){busy?startChrono():(!isMobile&&hasFocusRef.current&&chatbotInputRef.current.focusInput(),stopChrono())}),[busy,startChrono,stopChrono,isMobile]);var saveMessages=useCallback((function(e){localStorageKey&&localStorage.setItem(localStorageKey,(0,_neko_ui__WEBPACK_IMPORTED_MODULE_3__.F1)({chatId,messages:e}))}),[localStorageKey,chatId]),resetError=function(){setError(null)};useEffect((function(){var e=[];if(localStorageKey&&(e=localStorage.getItem(localStorageKey)))return e=JSON.parse(e),setMessages(e.messages),void setChatId(e.chatId);resetMessages()}),[botId]);var handleActions=useCallback((function(actions,lastMessage){actions=actions||[];var callsCount=0,_iterator=_createForOfIteratorHelper(actions),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var action=_step.value;if("function"===action.type){var data=action.data||{},_data$name=data.name,name=void 0===_data$name?null:_data$name,_data$args=data.args,args=void 0===_data$args?[]:_data$args,finalArgs=args?Object.values(args).map((function(e){return JSON.stringify(e)})):[];try{debugMode&&console.log("[CHATBOT] CALL ".concat(name,"(").concat(finalArgs.join(", "),")")),eval("".concat(name,"(").concat(finalArgs.join(", "),")")),callsCount++}catch(e){console.error("Error while executing an action.",e)}}}}catch(e){_iterator.e(e)}finally{_iterator.f()}!lastMessage.content&&callsCount>0&&(lastMessage.content="*Done!*")}),[debugMode]),handleShortcuts=useCallback((function(e){setShortcuts(e||[])}),[]),handleBlocks=useCallback((function(e){setBlocks(e||[])}),[]);useEffect((function(){if(serverReply){setBusy(!1);var e=_toConsumableArray(messages),t=e.length>0?e[e.length-1]:null;if(!serverReply.success)return"assistant"===t.role&&t.isQuerying&&e.pop(),e.pop(),e.push({id:(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.vx)(),role:"system",content:serverReply.message,who:rawAiName,timestamp:(new Date).getTime()}),setMessages(e),void saveMessages(e);if("assistant"===t.role&&t.isQuerying)t.content=(0,_app_chatbot_MwaiAPI__WEBPACK_IMPORTED_MODULE_2__.W5)("ai.reply",serverReply.reply,{chatId,botId}),serverReply.images&&(t.images=serverReply.images),t.timestamp=(new Date).getTime(),delete t.isQuerying,handleActions(null==serverReply?void 0:serverReply.actions,t),handleBlocks(null==serverReply?void 0:serverReply.blocks),handleShortcuts(null==serverReply?void 0:serverReply.shortcuts);else if("assistant"===t.role&&t.isStreaming)t.content=(0,_app_chatbot_MwaiAPI__WEBPACK_IMPORTED_MODULE_2__.W5)("ai.reply",serverReply.reply,{chatId,botId}),serverReply.images&&(t.images=serverReply.images),t.timestamp=(new Date).getTime(),delete t.isStreaming,handleActions(null==serverReply?void 0:serverReply.actions,t),handleBlocks(null==serverReply?void 0:serverReply.blocks),handleShortcuts(null==serverReply?void 0:serverReply.shortcuts);else{var r={id:(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.vx)(),role:"assistant",content:(0,_app_chatbot_MwaiAPI__WEBPACK_IMPORTED_MODULE_2__.W5)("ai.reply",serverReply.reply,{botId,chatId,customId}),who:rawAiName,timestamp:(new Date).getTime()};serverReply.images&&(r.images=serverReply.images),handleActions(null==serverReply?void 0:serverReply.actions,r),handleBlocks(null==serverReply?void 0:serverReply.blocks),handleShortcuts(null==serverReply?void 0:serverReply.shortcuts),e.push(r)}setMessages(e),saveMessages(e)}}),[serverReply]);var onClear=useCallback(_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,setChatId((0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.vx)());case 2:localStorageKey&&localStorage.removeItem(localStorageKey),resetMessages(),setInputText(""),setShortcuts([]),setBlocks([]);case 7:case"end":return e.stop()}}),e)}))),[botId]),onSubmit=useCallback(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n,o,a,i,s,c,u,l,p,f,d,m,h,y;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!busy){e.next=3;break}return console.error("AI Engine: There is already a query in progress."),e.abrupt("return");case 3:if("string"!=typeof t&&(t=inputText),n=uploadedFile,o=null==uploadedFile?void 0:uploadedFile.uploadedUrl,a=null==uploadedFile||null===(r=uploadedFile.localFile)||void 0===r?void 0:r.type,i=!!a&&a.startsWith("image"),s=t,o&&(s=i?"![Uploaded Image](".concat(o,")\n").concat(t):"[Uploaded File](".concat(o,")\n").concat(t)),setBusy(!0),setInputText(""),setShortcuts([]),setBlocks([]),resetUploadedFile(),c=[].concat(_toConsumableArray(messages),[{id:(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.vx)(),role:"user",content:s,who:rawUserName,timestamp:(new Date).getTime()}]),saveMessages(c),u=(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.vx)(),l=[].concat(_toConsumableArray(c),[{id:u,role:"assistant",content:null,who:rawAiName,timestamp:null,isQuerying:!stream,isStreaming:!!stream}]),setMessages(l),p=_objectSpread({botId,customId,session:sessionId,chatId,contextId,messages,newMessage:t,newFileId:null==n?void 0:n.uploadedId,stream},atts),e.prev=21,debugMode&&console.log("[CHATBOT] OUT: ",p),f=stream?function(e){setMessages((function(t){var r=_toConsumableArray(t),n=r.length>0?r[r.length-1]:null;return n&&n.id===u&&(n.content=e,n.timestamp=(new Date).getTime()),r}))}:null,null==restNonce){e.next=28;break}e.t0=restNonce,e.next=31;break;case 28:return e.next=30,refreshRestNonce();case 30:e.t0=e.sent;case 31:return d=e.t0,e.next=34,(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.ti)("".concat(restUrl,"/mwai-ui/v1/chats/submit"),p,d,stream);case 34:return m=e.sent,e.next=37,(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.Pn)(m,f,debugMode?"CHATBOT":null);case 37:if((h=e.sent).success||!h.message){e.next=47;break}return setError(h.message),(y=_toConsumableArray(l)).pop(),y.pop(),setMessages(y),saveMessages(y),setBusy(!1),e.abrupt("return");case 47:setServerReply(h),e.next=54;break;case 50:e.prev=50,e.t1=e.catch(21),console.error("An error happened in the handling of the chatbot response.",{err:e.t1}),setBusy(!1);case 54:case"end":return e.stop()}}),e,null,[[21,50]])})));return function(t){return e.apply(this,arguments)}}(),[busy,uploadedFile,messages,saveMessages,stream,botId,customId,sessionId,chatId,contextId,atts,inputText,debugMode,restNonce,refreshRestNonce,restUrl]),onSubmitAction=useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(null==uploadedFile||!uploadedFile.uploadedId);hasFocusRef.current=document.activeElement===chatbotInputRef.current.currentElement(),e?onSubmit(e):(t||inputText.length>0)&&onSubmit(inputText)}),[inputText,onSubmit,null==uploadedFile?void 0:uploadedFile.uploadedId]),onFileUpload=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,n,o,a,i,s,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:"N/A",n=c.length>2&&void 0!==c[2]?c[2]:"N/A",e.prev=2,null!==t){e.next=6;break}return resetUploadedFile(),e.abrupt("return");case 6:if(o={type:r,purpose:n},a="".concat(restUrl,"/mwai-ui/v1/files/upload"),null==restNonce){e.next=12;break}e.t0=restNonce,e.next=15;break;case 12:return e.next=14,refreshRestNonce();case 14:e.t0=e.sent;case 15:return i=e.t0,e.next=18,(0,_app_helpers__WEBPACK_IMPORTED_MODULE_1__.uE)(a,t,i,(function(e){setUploadedFile({localFile:t,uploadedId:null,uploadedUrl:null,uploadProgress:e})}),o);case 18:s=e.sent,setUploadedFile({localFile:t,uploadedId:s.data.id,uploadedUrl:s.data.url,uploadProgress:null}),e.next=27;break;case 22:e.prev=22,e.t1=e.catch(2),console.error("onFileUpload Error",e.t1),setError(e.t1.message||"An unknown error occurred"),resetUploadedFile();case 27:case"end":return e.stop()}}),e,null,[[2,22]])})));return function(t){return e.apply(this,arguments)}}(),onUploadFile=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return error&&resetError(),e.abrupt("return",onFileUpload(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),resetUploadedFile=function(){setUploadedFile({localFile:null,uploadedId:null,uploadedUrl:null,uploadProgress:null})},runTimer=useCallback((function(){var e=setTimeout((function(){setOpen((function(e){return e||setShowIconMessage(!0),e}))}),1e3*iconTextDelay);return function(){return clearTimeout(e)}}),[iconText,iconTextDelay]);useEffect((function(){if(iconText&&!iconTextDelay)setShowIconMessage(!0);else if(iconText&&iconTextDelay)return runTimer()}),[iconText]);var _useState37=useState([]),_useState38=_slicedToArray(_useState37,2),tasks=_useState38[0],setTasks=_useState38[1],runTasks=useCallback(_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r,n,o,a,i,s,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:tasks.length>0&&("ask"===(t=tasks[0]).action?(r=t.data,n=r.text,r.submit?onSubmit(n):setInputText(n)):"toggle"===t.action?setOpen((function(e){return!e})):"open"===t.action?setOpen(!0):"close"===t.action?setOpen(!1):"clear"===t.action?onClear():"setContext"===t.action?(o=t.data,a=o.chatId,i=o.messages,setChatId(a),setMessages(i)):"setShortcuts"===t.action?(s=t.data,handleShortcuts(s)):"setBlocks"===t.action&&(c=t.data,handleBlocks(c)),setTasks((function(e){return e.slice(1)})));case 1:case"end":return e.stop()}}),e)}))),[tasks,onClear,onSubmit,setChatId,setInputText,setMessages,setOpen,handleShortcuts,handleBlocks]);useEffect((function(){runTasks()}),[runTasks]);var actions={setInputText,saveMessages,setMessages,resetMessages,resetError,onClear,onSubmit,onSubmitAction,onFileUpload,onUploadFile,setOpen,setWindowed,setShowIconMessage,setIsListening,setDraggingType,setIsBlocked},state={theme,botId,customId,userData,pluginUrl,inputText,messages,shortcuts,blocks,busy,error,setBusy,typewriter,speechRecognition,speechSynthesis,virtualKeyboardFix,localMemory,imageUpload,uploadedFile,fileSearch,textSend,textClear,textInputMaxLength,textInputPlaceholder,textCompliance,aiName,userName,guestName,aiAvatar,userAvatar,guestAvatar,aiAvatarUrl,userAvatarUrl,guestAvatarUrl,isWindow,copyButton,fullscreen,icon,iconText,iconAlt,iconPosition,iconBubble,cssVariables,iconUrl,chatbotInputRef,conversationRef,isMobile,open,locked,windowed,showIconMessage,timeElapsed,isListening,speechRecognitionAvailable,uploadIconPosition,submitButtonConf,draggingType,isBlocked,busyNonce};return React.createElement(ChatbotContext.Provider,{value:{state,actions}},children)}},137:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:String(t)}r.d(t,{HX:()=>s,W5:()=>c});var i=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"undefined"!=typeof window&&window.MwaiAPI)return window.MwaiAPI;this.chatbots=[],this.filters={},this.actions={},"undefined"!=typeof window&&(window.MwaiAPI=this)}var t,r;return t=e,r=[{key:"getChatbot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this.chatbots.find((function(t){return t.botId===e||t.customId===e})):this.chatbots[0]}},{key:"addFilter",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.filters[e]||(this.filters[e]=[]),this.filters[e].push({callback:t,priority:r}),this.filters[e].sort((function(e,t){return e.priority-t.priority}))}},{key:"applyFilters",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return this.filters[e]?this.filters[e].reduce((function(e,t){return t.callback.apply(t,[e].concat(n))}),t):t}},{key:"addAction",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.actions[e]||(this.actions[e]=[]),this.actions[e].push({callback:t,priority:r}),this.actions[e].sort((function(e,t){return e.priority-t.priority}))}},{key:"doAction",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.actions[e]&&this.actions[e].forEach((function(e){e.callback.apply(e,r)}))}}],r&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),s=function(){if("undefined"!=typeof window&&window.MwaiAPI)return window.MwaiAPI;var e=new i;return"undefined"!=typeof window&&(window.MwaiAPI=e),e}(),c=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return s.applyFilters.apply(s,[e,t].concat(n))}},966:(e,t,r)=>{r.d(t,{$$:()=>y,Vw:()=>w,_$:()=>_,bE:()=>S,dh:()=>b,gR:()=>v,kW:()=>x,mv:()=>g,tm:()=>h});var n=["active","disabled"],o=["if","className","disableTransition","children"];function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}function c(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var u=wp.element,l=u.useState,p=u.useMemo,f=u.useEffect,d=u.useRef,m=u.useCallback,h=function(e){var t=e.active,r=e.disabled,o=c(e,n);return React.createElement("div",s({active:t?"true":"false",disabled:r},o),React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",dangerouslySetInnerHTML:{__html:'<path d="M192 0C139 0 96 43 96 96V256c0 53 43 96 96 96s96-43 96-96V96c0-53-43-96-96-96zM64 216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 89.1 66.2 162.7 152 174.4V464H120c-13.3 0-24 10.7-24 24s10.7 24 24 24h72 72c13.3 0 24-10.7 24-24s-10.7-24-24-24H216V430.4c85.8-11.7 152-85.3 152-174.4V216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 70.7-57.3 128-128 128s-128-57.3-128-128V216z"/>'}}))};function y(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=d();f((function(){n.current=t}),[t]),f((function(){if(null!==e&&r){var t=setInterval((function(){n.current()}),e);return function(){return clearInterval(t)}}}),[e,r])}var v=function(){return p((function(){return function(e,t){return Array.isArray(e)||(e=[e]),t&&Object.entries(t).forEach((function(t){var r=a(t,2),n=r[0];r[1]&&e.push(n)})),e.join(" ")}}),[])};function g(e){return!(!e||"string"!=typeof e)&&0===e.indexOf("http")}function b(){var e=a(l(null),2),t=e[0],r=e[1],n=d(null);return f((function(){return function(){clearInterval(n.current)}}),[]),{timeElapsed:t,startChrono:function(){if(null===n.current){var e=Date.now();n.current=setInterval((function(){var t,n,o,a=Math.floor((Date.now()-e)/1e3);r((t=a,n=Math.floor(t/60),o=t%60,"".concat(n,":").concat(o.toString().padStart(2,"0"))))}),500)}},stopChrono:function(){clearInterval(n.current),n.current=null,r(null)}}}var _=function(e){var t,r,n,o,a,i,s,c,u,l,p,f,d,m,h,y,v,g,b,_,w,S,x,E,k,O,I,A,R=null!==(t=null===(r=e.guestName)||void 0===r?void 0:r.trim())&&void 0!==t?t:"",C=null!==(n=null===(o=e.textSend)||void 0===o?void 0:o.trim())&&void 0!==n?n:"",T=null!==(a=null===(i=e.textClear)||void 0===i?void 0:i.trim())&&void 0!==a?a:"",P=parseInt(e.textInputMaxLength),j=null!==(s=null===(c=e.textInputPlaceholder)||void 0===c?void 0:c.trim())&&void 0!==s?s:"",L=null!==(u=null===(l=e.textCompliance)||void 0===l?void 0:l.trim())&&void 0!==u?u:"",M=Boolean(e.window),N=Boolean(e.copyButton),F=Boolean(e.fullscreen),U=null!==(p=null===(f=e.icon)||void 0===f?void 0:f.trim())&&void 0!==p?p:"",D=null!==(d=null===(m=e.iconText)||void 0===m?void 0:m.trim())&&void 0!==d?d:"",B=parseInt(e.iconTextDelay||1),$=null!==(h=null===(y=e.iconAlt)||void 0===y?void 0:y.trim())&&void 0!==h?h:"",W=null!==(v=null===(g=e.iconPosition)||void 0===g?void 0:g.trim())&&void 0!==v?v:"",H=Boolean(e.iconBubble),K=null!==(b=null===(_=e.aiName)||void 0===_?void 0:_.trim())&&void 0!==b?b:"",z=null!==(w=null===(S=e.userName)||void 0===S?void 0:S.trim())&&void 0!==w?w:"",G=Boolean(null==e?void 0:e.aiAvatar),q=Boolean(null==e?void 0:e.userAvatar),V=Boolean(null==e?void 0:e.guestAvatar),Q=G?null!==(x=null==e||null===(E=e.aiAvatarUrl)||void 0===E?void 0:E.trim())&&void 0!==x?x:"":null,J=q?null!==(k=null==e||null===(O=e.userAvatarUrl)||void 0===O?void 0:O.trim())&&void 0!==k?k:"":null,X=V?null!==(I=null==e||null===(A=e.guestAvatarUrl)||void 0===A?void 0:A.trim())&&void 0!==I?I:"":null;return{textSend:C,textClear:T,textInputMaxLength:P,textInputPlaceholder:j,textCompliance:L,window:M,copyButton:N,fullscreen:F,localMemory:Boolean(e.localMemory),imageUpload:Boolean(e.imageUpload),fileSearch:Boolean(e.fileSearch),icon:U,iconText:D,iconTextDelay:B,iconAlt:$,iconPosition:W,iconBubble:H,aiName:K,userName:z,guestName:R,aiAvatar:G,userAvatar:q,guestAvatar:V,aiAvatarUrl:Q,userAvatarUrl:J,guestAvatarUrl:X}},w=function(e){var t=a(l(!1),2),r=t[0],n=t[1],o=a(l(!1),2),i=o[0],s=o[1];return f((function(){"undefined"!=typeof window&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window)&&s(!0)}),[]),f((function(){if(i){var t=new(window.SpeechRecognition||window.webkitSpeechRecognition),o=null;return navigator.userAgent.toLowerCase().indexOf("android")>-1?(t.interimResults=!1,t.continuous=!1,o=function(t){var r=Array.from(t.results).filter((function(e){return e.isFinal})).map((function(e){return e[0].transcript})).join("");e(r),n(!1)}):(t.interimResults=!0,t.continuous=!0,o=function(t){var r=Array.from(t.results).map((function(e){return e[0]})).map((function(e){return e.transcript})).join("");e(r)}),r?(t.addEventListener("result",o),t.start()):(t.removeEventListener("result",o),t.abort()),function(){t.abort()}}}),[r,i]),{isListening:r,setIsListening:n,speechRecognitionAvailable:i}},S=function(e){var t=e.if,r=e.className,n=e.disableTransition,i=void 0!==n&&n,u=e.children,p=c(e,o),d=a(l(!1),2),m=d[0],h=d[1],y=a(l("mwai-transition"),2),v=y[0],g=y[1];return f((function(){i?h(t):t?(h(!0),setTimeout((function(){g("mwai-transition mwai-transition-visible")}),150)):g("mwai-transition")}),[t,i]),m?React.createElement("div",s({className:"".concat(r," ").concat(i?"":v),onTransitionEnd:function(){"mwai-transition"!==v||i||h(!1)}},p),u):null},x=function(){var e=a(l(window.visualViewport.height),2),t=e[0],r=e[1],n=p((function(){return/Android/.test(navigator.userAgent)}),[]),o=p((function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}),[]),i=d(window.visualViewport),s=m((function(){r(i.current.height)}),[]);return f((function(){var e=i.current;return e.addEventListener("resize",s),o?(window.addEventListener("resize",s),document.addEventListener("focusin",s)):e.addEventListener("scroll",s),function(){e.removeEventListener("resize",s),o?(window.removeEventListener("resize",s),document.removeEventListener("focusin",s)):e.removeEventListener("scroll",s)}}),[s,o]),{viewportHeight:t,isIOS:o,isAndroid:n}}},678:(e,t,r)=>{r.d(t,{Pn:()=>d,Ve:()=>S,rn:()=>_,ti:()=>h,uE:()=>v,vx:()=>b});var n=r(296);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(){a=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function p(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(e){p=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var o=t&&t.prototype instanceof b?t:b,a=Object.create(o.prototype),s=new P(n||[]);return i(a,"_invoke",{value:A(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var m="suspendedStart",h="suspendedYield",y="executing",v="completed",g={};function b(){}function _(){}function w(){}var S={};p(S,c,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(j([])));E&&E!==r&&n.call(E,c)&&(S=E);var k=w.prototype=b.prototype=Object.create(S);function O(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function r(a,i,s,c){var u=d(e[a],e,i);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==o(p)&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(p).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function A(t,r,n){var o=m;return function(a,i){if(o===y)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=R(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===m)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var u=d(t,r,n);if("normal"===u.type){if(o=n.done?v:h,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function R(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,R(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(o(t)+" is not iterable")}return _.prototype=w,i(k,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:_,configurable:!0}),_.displayName=p(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,p(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},O(I.prototype),p(I.prototype,u,(function(){return this})),t.AsyncIterator=I,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new I(f(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},O(k),p(k,l,"Generator"),p(k,c,(function(){return this})),p(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){c(a,n,o,i,s,"next",e)}function s(e){c(a,n,o,i,s,"throw",e)}i(void 0)}))}}var l=wp.element,p=(l.useMemo,l.useEffect),f=l.useState;function d(e,t){return m.apply(this,arguments)}function m(){return m=u(a().mark((function e(t,r){var n,o,i,s,c,u,l,p,f,d,m,h,y,v,g=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=g.length>2&&void 0!==g[2]?g[2]:null,r){e.next=14;break}return e.prev=2,e.next=5,t.json();case 5:return o=e.sent,n&&console.log("[".concat(n,"] IN: "),o),e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(2),console.error("Could not parse the regular response.",{err:e.t0,data}),e.abrupt("return",{success:!1,message:"Could not parse the regular response."});case 14:i=t.body.getReader(),s=new TextDecoder("utf-8"),c="",u="";case 18:return e.next=21,i.read();case 21:if(l=e.sent,p=l.value,f=l.done,c+=s.decode(p,{stream:!0}),!f){e.next=27;break}return e.abrupt("break",68);case 27:d=c.split("\n"),m=0;case 29:if(!(m<d.length-1)){e.next=65;break}if(0===d[m].indexOf("data: ")){e.next=32;break}return e.abrupt("continue",62);case 32:if("live"!==(h=JSON.parse(d[m].replace("data: ",""))).type){e.next=39;break}n&&console.log("[".concat(n," STREAM] LIVE: "),h),u+=h.data,r&&r(u,h.data),e.next=62;break;case 39:if("error"!==h.type){e.next=51;break}return e.prev=40,n&&console.error("[".concat(n," STREAM] ERROR: "),h.data),e.abrupt("return",{success:!1,message:h.data});case 45:return e.prev=45,e.t1=e.catch(40),console.error("Could not parse the 'error' stream.",{err:e.t1,data:h}),e.abrupt("return",{success:!1,message:"Could not parse the 'error' stream."});case 49:e.next=62;break;case 51:if("end"!==h.type){e.next=62;break}return e.prev=52,y=JSON.parse(h.data),n&&console.log("[".concat(n," STREAM] END: "),y),e.abrupt("return",y);case 58:return e.prev=58,e.t2=e.catch(52),console.error("Could not parse the 'end' stream.",{err:e.t2,data:h}),e.abrupt("return",{success:!1,message:"Could not parse the 'end' stream."});case 62:m++,e.next=29;break;case 65:c=d[d.length-1],e.next=18;break;case 68:return e.prev=68,v=JSON.parse(c),n&&console.log("[".concat(n," STREAM] IN: "),v),e.abrupt("return",v);case 74:return e.prev=74,e.t3=e.catch(68),console.error("Could not parse the buffer.",{err:e.t3,buffer:c}),e.abrupt("return",{success:!1,message:"Could not parse the buffer."});case 78:case"end":return e.stop()}}),e,null,[[2,10],[40,45],[52,58],[68,74]])}))),m.apply(this,arguments)}function h(e,t,r,n){return y.apply(this,arguments)}function y(){return(y=u(a().mark((function e(t,r,o,i){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={"Content-Type":"application/json"},o&&(s["X-WP-Nonce"]=o),i&&(s.Accept="text/event-stream"),e.next=5,fetch("".concat(t),{method:"POST",headers:s,body:(0,n.F1)(r)});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t,r,n){return g.apply(this,arguments)}function g(){return g=u(a().mark((function e(t,r,n,o){var s,c=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.length>4&&void 0!==c[4]?c[4]:{},e.abrupt("return",new Promise((function(e,a){var c=new FormData;c.append("file",r);for(var u=0,l=Object.entries(s);u<l.length;u++){var p=i(l[u],2),f=p[0],d=p[1];c.append(f,d)}var m=new XMLHttpRequest;m.open("POST",t,!0),n&&m.setRequestHeader("X-WP-Nonce",n),m.upload.onprogress=function(e){if(e.lengthComputable&&o){var t=e.loaded/e.total*100;o(t)}},m.onload=function(){if(m.status>=200&&m.status<300)try{var t=JSON.parse(m.responseText);e(t)}catch(e){a({status:m.status,statusText:m.statusText,error:"The server response is not valid JSON"})}else{try{var r=JSON.parse(m.responseText);return void a({status:m.status,message:r.message})}catch(e){}a({status:m.status,statusText:m.statusText})}},m.onerror=function(){a({status:m.status,statusText:m.statusText})},m.send(c)})));case 2:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function b(){return Math.random().toString(36).substring(2)}var _=function(){var e=i(f(!0),2),t=e[0],r=e[1];p((function(){var e=setTimeout((function(){var e=setInterval((function(){r((function(e){return!e}))}),500);return function(){return clearInterval(e)}}),200);return function(){return clearTimeout(e)}}),[]);var n={opacity:t?1:0,width:"1px",height:"1em",borderLeft:"8px solid",marginLeft:"2px"};return React.createElement("span",{style:n})},w=/([\u2700-\u27BF]|[\uE000-\uF8FF]|[\uD800-\uDFFF]|[\uFE00-\uFE0F]|[\u1F100-\u1F1FF]|[\u1F200-\u1F2FF]|[\u1F300-\u1F5FF]|[\u1F600-\u1F64F]|[\u1F680-\u1F6FF]|[\u1F700-\u1F77F]|[\u1F780-\u1F7FF]|[\u1F800-\u1F8FF]|[\u1F900-\u1F9FF]|[\u1FA00-\u1FA6F])/;function S(e){return e&&2===e.length&&w.test(e)}},296:(e,t,r)=>{r.d(t,{F1:()=>i});var n=r(594);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var a=function(e){var t=[];return function(r,n){if("object"===o(n)&&null!==n){if(-1!==t.indexOf(n)){if(!e)throw console.warn("Circular reference found.",{key:r,value:n,cache:t,cacheIndex:t.indexOf(n)}),new Error("Circular reference found. Cancelled.");return}t.push(n)}return n}};function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return JSON.stringify(e,a(r),t)}r.n(n)().Component},594:e=>{e.exports=React}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{var e=__webpack_require__(469),t=__webpack_require__(594);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r.apply(this,arguments)}const n=["children","options"];var o,a;!function(e){e.blockQuote="0",e.breakLine="1",e.breakThematic="2",e.codeBlock="3",e.codeFenced="4",e.codeInline="5",e.footnote="6",e.footnoteReference="7",e.gfmTask="8",e.heading="9",e.headingSetext="10",e.htmlBlock="11",e.htmlComment="12",e.htmlSelfClosing="13",e.image="14",e.link="15",e.linkAngleBraceStyleDetector="16",e.linkBareUrlDetector="17",e.linkMailtoDetector="18",e.newlineCoalescer="19",e.orderedList="20",e.paragraph="21",e.ref="22",e.refImage="23",e.refLink="24",e.table="25",e.tableSeparator="26",e.text="27",e.textBolded="28",e.textEmphasized="29",e.textEscaped="30",e.textMarked="31",e.textStrikethroughed="32",e.unorderedList="33"}(o||(o={})),function(e){e[e.MAX=0]="MAX",e[e.HIGH=1]="HIGH",e[e.MED=2]="MED",e[e.LOW=3]="LOW",e[e.MIN=4]="MIN"}(a||(a={}));const i=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","className","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce(((e,t)=>(e[t.toLowerCase()]=t,e)),{for:"htmlFor"}),s={amp:"&",apos:"'",gt:">",lt:"<",nbsp:" ",quot:"“"},c=["style","script"],u=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,l=/mailto:/i,p=/\n{2,}$/,f=/^( *>[^\n]+(\n[^\n]+)*\n*)+\n{2,}/,d=/^ *> ?/gm,m=/^ {2,}\n/,h=/^(?:( *[-*_])){3,} *(?:\n *)+\n/,y=/^\s*(`{3,}|~{3,}) *(\S+)?([^\n]*?)?\n([\s\S]+?)\s*\1 *(?:\n *)*\n?/,v=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,g=/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,b=/^(?:\n *)*\n/,_=/\r\n?/g,w=/^\[\^([^\]]+)](:.*)\n/,S=/^\[\^([^\]]+)]/,x=/\f/g,E=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,k=/^\s*?\[(x|\s)\]/,O=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,I=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,A=/^([^\n]+)\n *(=|-){3,} *(?:\n *)+\n/,R=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?([^>]*)\/{0}>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1)[\s\S])*?)<\/\1>\n*/i,C=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,T=/^<!--[\s\S]*?(?:-->)/,P=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,j=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,L=/^\{.*\}$/,M=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,N=/^<([^ >]+@[^ >]+)>/,F=/^<([^ >]+:\/[^ >]+)>/,U=/-([a-z])?/gi,D=/^(.*\|?.*)\n *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*)\n?/,B=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,$=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,W=/^\[([^\]]*)\] ?\[([^\]]*)\]/,H=/(\[|\])/g,K=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,z=/\t/g,G=/^ *\| */,q=/(^ *\||\| *$)/g,V=/ *$/,Q=/^ *:-+: *$/,J=/^ *:-+ *$/,X=/^ *-+: *$/,Y=/^([*_])\1((?:\[.*?\][([].*?[)\]]|<.*?>(?:.*?<.*?>)?|`.*?`|~+.*?~+|.)*?)\1\1(?!\1)/,Z=/^([*_])((?:\[.*?\][([].*?[)\]]|<.*?>(?:.*?<.*?>)?|`.*?`|~+.*?~+|.)*?)\1(?!\1|\w)/,ee=/^==((?:\[.*?\]|<.*?>(?:.*?<.*?>)?|`.*?`|.)*?)==/,te=/^~~((?:\[.*?\]|<.*?>(?:.*?<.*?>)?|`.*?`|.)*?)~~/,re=/^\\([^0-9A-Za-z\s])/,ne=/^[\s\S]+?(?=[^0-9A-Z\s\u00c0-\uffff&#;.()'"]|\d+\.|\n\n| {2,}\n|\w+:\S|$)/i,oe=/^\n+/,ae=/^([ \t]*)/,ie=/\\([^\\])/g,se=/ *\n+$/,ce=/(?:^|\n)( *)$/,ue="(?:\\d+\\.)",le="(?:[*+-])";function pe(e){return"( *)("+(1===e?ue:le)+") +"}const fe=pe(1),de=pe(2);function me(e){return new RegExp("^"+(1===e?fe:de))}const he=me(1),ye=me(2);function ve(e){return new RegExp("^"+(1===e?fe:de)+"[^\\n]*(?:\\n(?!\\1"+(1===e?ue:le)+" )[^\\n]*)*(\\n|$)","gm")}const ge=ve(1),be=ve(2);function _e(e){const t=1===e?ue:le;return new RegExp("^( *)("+t+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+t+" (?!"+t+" ))\\n*|\\s*\\n*$)")}const we=_e(1),Se=_e(2);function xe(e,t){const r=1===t,n=r?we:Se,o=r?ge:be,a=r?he:ye;return{match(e,t,r){const o=ce.exec(r);return o&&(t.list||!t.inline&&!t.simple)?n.exec(e=o[1]+e):null},order:1,parse(e,t,n){const i=r?+e[2]:void 0,s=e[0].replace(p,"\n").match(o);let c=!1;return{items:s.map((function(e,r){const o=a.exec(e)[0].length,i=new RegExp("^ {1,"+o+"}","gm"),u=e.replace(i,"").replace(a,""),l=r===s.length-1,p=-1!==u.indexOf("\n\n")||l&&c;c=p;const f=n.inline,d=n.list;let m;n.list=!0,p?(n.inline=!1,m=u.replace(se,"\n\n")):(n.inline=!0,m=u.replace(se,""));const h=t(m,n);return n.inline=f,n.list=d,h})),ordered:r,start:i}},render:(t,r,n)=>e(t.ordered?"ol":"ul",{key:n.key,start:"20"===t.type?t.start:void 0},t.items.map((function(t,o){return e("li",{key:o},r(t,n))})))}}const Ee=/^\[([^\]]*)]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/,ke=/^!\[([^\]]*)]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/,Oe=[f,y,v,O,A,I,T,D,ge,we,be,Se],Ie=[...Oe,/^[^\n]+(?:  \n|\n{2,})/,R,j];function Ae(e){return e.replace(/[ÀÁÂÃÄÅàáâãäåæÆ]/g,"a").replace(/[çÇ]/g,"c").replace(/[ðÐ]/g,"d").replace(/[ÈÉÊËéèêë]/g,"e").replace(/[ÏïÎîÍíÌì]/g,"i").replace(/[Ññ]/g,"n").replace(/[øØœŒÕõÔôÓóÒò]/g,"o").replace(/[ÜüÛûÚúÙù]/g,"u").replace(/[ŸÿÝý]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function Re(e){return X.test(e)?"right":Q.test(e)?"center":J.test(e)?"left":null}function Ce(e,t,r){const n=r.inTable;r.inTable=!0;const o=t(e.trim(),r);r.inTable=n;let a=[[]];return o.forEach((function(e,t){"26"===e.type?0!==t&&t!==o.length-1&&a.push([]):("27"!==e.type||null!=o[t+1]&&"26"!==o[t+1].type||(e.text=e.text.replace(V,"")),a[a.length-1].push(e))})),a}function Te(e,t,r){r.inline=!0;const n=Ce(e[1],t,r),o=e[2].replace(q,"").split("|").map(Re),a=function(e,t,r){return e.trim().split("\n").map((function(e){return Ce(e,t,r)}))}(e[3],t,r);return r.inline=!1,{align:o,cells:a,header:n,type:"25"}}function Pe(e,t){return null==e.align[t]?{}:{textAlign:e.align[t]}}function je(e){return function(t,r){return r.inline?e.exec(t):null}}function Le(e){return function(t,r){return r.inline||r.simple?e.exec(t):null}}function Me(e){return function(t,r){return r.inline||r.simple?null:e.exec(t)}}function Ne(e){return function(t){return e.exec(t)}}function Fe(e,t,r){if(t.inline||t.simple)return null;if(r&&!r.endsWith("\n"))return null;let n="";e.split("\n").every((e=>!Oe.some((t=>t.test(e)))&&(n+=e+"\n",e.trim())));const o=n.trimEnd();return""==o?null:[n,o]}function Ue(e){try{if(decodeURIComponent(e).replace(/[^A-Za-z0-9/:]/g,"").match(/^\s*(javascript|vbscript|data(?!:image)):/i))return}catch(e){return null}return e}function De(e){return e.replace(ie,"$1")}function Be(e,t,r){const n=r.inline||!1,o=r.simple||!1;r.inline=!0,r.simple=!0;const a=e(t,r);return r.inline=n,r.simple=o,a}function $e(e,t,r){const n=r.inline||!1,o=r.simple||!1;r.inline=!1,r.simple=!0;const a=e(t,r);return r.inline=n,r.simple=o,a}function We(e,t,r){return r.inline=!1,e(t,r)}const He=(e,t,r)=>({children:Be(t,e[1],r)});function Ke(){return{}}function ze(){return null}function Ge(...e){return e.filter(Boolean).join(" ")}function qe(e,t,r){let n=e;const o=t.split(".");for(;o.length&&(n=n[o[0]],void 0!==n);)o.shift();return n||r}function Ve(e,n={}){n.overrides=n.overrides||{},n.slugify=n.slugify||Ae,n.namedCodesToUnicode=n.namedCodesToUnicode?r({},s,n.namedCodesToUnicode):s;const o=n.createElement||t.createElement;function a(e,t,...a){const i=qe(n.overrides,`${e}.props`,{});return o(function(e,t){const r=qe(t,e);return r?"function"==typeof r||"object"==typeof r&&"render"in r?r:qe(t,`${e}.component`,e):e}(e,n.overrides),r({},t,i,{className:Ge(null==t?void 0:t.className,i.className)||void 0}),...a)}function p(e){e=e.replace(E,"");let r=!1;n.forceInline?r=!0:n.forceBlock||(r=!1===K.test(e));const o=ie(X(r?e:`${e.trimEnd().replace(oe,"")}\n\n`,{inline:r}));for(;"string"==typeof o[o.length-1]&&!o[o.length-1].trim();)o.pop();if(null===n.wrapper)return o;const i=n.wrapper||(r?"span":"div");let s;if(o.length>1||n.forceWrapper)s=o;else{if(1===o.length)return s=o[0],"string"==typeof s?a("span",{key:"outer"},s):s;s=null}return t.createElement(i,{key:"outer"},s)}function q(e){const r=e.match(u);return r?r.reduce((function(e,r,n){const o=r.indexOf("=");if(-1!==o){const a=function(e){return-1!==e.indexOf("-")&&null===e.match(P)&&(e=e.replace(U,(function(e,t){return t.toUpperCase()}))),e}(r.slice(0,o)).trim(),s=function(e){const t=e[0];return('"'===t||"'"===t)&&e.length>=2&&e[e.length-1]===t?e.slice(1,-1):e}(r.slice(o+1).trim()),c=i[a]||a,u=e[c]=function(e,t){return"style"===e?t.split(/;\s?/).reduce((function(e,t){const r=t.slice(0,t.indexOf(":"));return e[r.replace(/(-[a-z])/g,(e=>e[1].toUpperCase()))]=t.slice(r.length+1).trim(),e}),{}):"href"===e||"src"===e?Ue(t):(t.match(L)&&(t=t.slice(1,t.length-1)),"true"===t||"false"!==t&&t)}(a,s);"string"==typeof u&&(R.test(u)||j.test(u))&&(e[c]=t.cloneElement(p(u.trim()),{key:n}))}else"style"!==r&&(e[i[r]||r]=!0);return e}),{}):null}const V=[],Q={},J={0:{match:Me(f),order:1,parse:(e,t,r)=>({children:t(e[0].replace(d,""),r)}),render:(e,t,r)=>a("blockquote",{key:r.key},t(e.children,r))},1:{match:Ne(m),order:1,parse:Ke,render:(e,t,r)=>a("br",{key:r.key})},2:{match:Me(h),order:1,parse:Ke,render:(e,t,r)=>a("hr",{key:r.key})},3:{match:Me(v),order:0,parse:e=>({lang:void 0,text:e[0].replace(/^ {4}/gm,"").replace(/\n+$/,"")}),render:(e,t,n)=>a("pre",{key:n.key},a("code",r({},e.attrs,{className:e.lang?`lang-${e.lang}`:""}),e.text))},4:{match:Me(y),order:0,parse:e=>({attrs:q(e[3]||""),lang:e[2]||void 0,text:e[4],type:"3"})},5:{match:Le(g),order:3,parse:e=>({text:e[2]}),render:(e,t,r)=>a("code",{key:r.key},e.text)},6:{match:Me(w),order:0,parse:e=>(V.push({footnote:e[2],identifier:e[1]}),{}),render:ze},7:{match:je(S),order:1,parse:e=>({target:`#${n.slugify(e[1])}`,text:e[1]}),render:(e,t,r)=>a("a",{key:r.key,href:Ue(e.target)},a("sup",{key:r.key},e.text))},8:{match:je(k),order:1,parse:e=>({completed:"x"===e[1].toLowerCase()}),render:(e,t,r)=>a("input",{checked:e.completed,key:r.key,readOnly:!0,type:"checkbox"})},9:{match:Me(n.enforceAtxHeadings?I:O),order:1,parse:(e,t,r)=>({children:Be(t,e[2],r),id:n.slugify(e[2]),level:e[1].length}),render:(e,t,r)=>a(`h${e.level}`,{id:e.id,key:r.key},t(e.children,r))},10:{match:Me(A),order:0,parse:(e,t,r)=>({children:Be(t,e[1],r),level:"="===e[2]?1:2,type:"9"})},11:{match:Ne(R),order:1,parse(e,t,r){const[,n]=e[3].match(ae),o=new RegExp(`^${n}`,"gm"),a=e[3].replace(o,""),i=(s=a,Ie.some((e=>e.test(s)))?We:Be);var s;const u=e[1].toLowerCase(),l=-1!==c.indexOf(u),p={attrs:q(e[2]),noInnerParse:l,tag:l?u:e[1]};return r.inAnchor=r.inAnchor||"a"===u,l?p.text=e[3]:p.children=i(t,a,r),r.inAnchor=!1,p},render:(e,t,n)=>a(e.tag,r({key:n.key},e.attrs),e.text||t(e.children,n))},13:{match:Ne(j),order:1,parse:e=>({attrs:q(e[2]||""),tag:e[1]}),render:(e,t,n)=>a(e.tag,r({},e.attrs,{key:n.key}))},12:{match:Ne(T),order:1,parse:()=>({}),render:ze},14:{match:Le(ke),order:1,parse:e=>({alt:e[1],target:De(e[2]),title:e[3]}),render:(e,t,r)=>a("img",{key:r.key,alt:e.alt||void 0,title:e.title||void 0,src:Ue(e.target)})},15:{match:je(Ee),order:3,parse:(e,t,r)=>({children:$e(t,e[1],r),target:De(e[2]),title:e[3]}),render:(e,t,r)=>a("a",{key:r.key,href:Ue(e.target),title:e.title},t(e.children,r))},16:{match:je(F),order:0,parse:e=>({children:[{text:e[1],type:"27"}],target:e[1],type:"15"})},17:{match:(e,t)=>t.inAnchor?null:je(M)(e,t),order:0,parse:e=>({children:[{text:e[1],type:"27"}],target:e[1],title:void 0,type:"15"})},18:{match:je(N),order:0,parse(e){let t=e[1],r=e[1];return l.test(r)||(r="mailto:"+r),{children:[{text:t.replace("mailto:",""),type:"27"}],target:r,type:"15"}}},20:xe(a,1),33:xe(a,2),19:{match:Me(b),order:3,parse:Ke,render:()=>"\n"},21:{match:Fe,order:3,parse:He,render:(e,t,r)=>a("p",{key:r.key},t(e.children,r))},22:{match:je(B),order:0,parse:e=>(Q[e[1]]={target:e[2],title:e[4]},{}),render:ze},23:{match:Le($),order:0,parse:e=>({alt:e[1]||void 0,ref:e[2]}),render:(e,t,r)=>a("img",{key:r.key,alt:e.alt,src:Ue(Q[e.ref].target),title:Q[e.ref].title})},24:{match:je(W),order:0,parse:(e,t,r)=>({children:t(e[1],r),fallbackChildren:t(e[0].replace(H,"\\$1"),r),ref:e[2]}),render:(e,t,r)=>Q[e.ref]?a("a",{key:r.key,href:Ue(Q[e.ref].target),title:Q[e.ref].title},t(e.children,r)):a("span",{key:r.key},t(e.fallbackChildren,r))},25:{match:Me(D),order:1,parse:Te,render:(e,t,r)=>a("table",{key:r.key},a("thead",null,a("tr",null,e.header.map((function(n,o){return a("th",{key:o,style:Pe(e,o)},t(n,r))})))),a("tbody",null,e.cells.map((function(n,o){return a("tr",{key:o},n.map((function(n,o){return a("td",{key:o,style:Pe(e,o)},t(n,r))})))}))))},26:{match:function(e,t){return t.inTable?(t.inline=!0,G.exec(e)):null},order:1,parse:function(){return{type:"26"}},render:()=>" | "},27:{match:Ne(ne),order:4,parse:e=>({text:e[0].replace(C,((e,t)=>n.namedCodesToUnicode[t]?n.namedCodesToUnicode[t]:e))}),render:e=>e.text},28:{match:Le(Y),order:2,parse:(e,t,r)=>({children:t(e[2],r)}),render:(e,t,r)=>a("strong",{key:r.key},t(e.children,r))},29:{match:Le(Z),order:3,parse:(e,t,r)=>({children:t(e[2],r)}),render:(e,t,r)=>a("em",{key:r.key},t(e.children,r))},30:{match:Le(re),order:1,parse:e=>({text:e[1],type:"27"})},31:{match:Le(ee),order:3,parse:He,render:(e,t,r)=>a("mark",{key:r.key},t(e.children,r))},32:{match:Le(te),order:3,parse:He,render:(e,t,r)=>a("del",{key:r.key},t(e.children,r))}};!0===n.disableParsingRawHTML&&(delete J[11],delete J[13]);const X=function(e){let t=Object.keys(e);function r(n,o){let a=[],i="";for(;n;){let s=0;for(;s<t.length;){const c=t[s],u=e[c],l=u.match(n,o,i);if(l){const e=l[0];n=n.substring(e.length);const t=u.parse(l,r,o);null==t.type&&(t.type=c),a.push(t),i=e;break}s++}}return a}return t.sort((function(t,r){let n=e[t].order,o=e[r].order;return n!==o?n-o:1})),function(e,t){return r(function(e){return e.replace(_,"\n").replace(x,"").replace(z,"    ")}(e),t)}}(J),ie=(se=function(e,t){return function(r,n,o){const a=e[r.type].render;return t?t((()=>a(r,n,o)),r,n,o):a(r,n,o)}}(J,n.renderRule),function e(t,r={}){if(Array.isArray(t)){const n=r.key,o=[];let a=!1;for(let n=0;n<t.length;n++){r.key=n;const i=e(t[n],r),s="string"==typeof i;s&&a?o[o.length-1]+=i:null!==i&&o.push(i),a=s}return r.key=n,o}return se(t,e,r)});var se;const ce=p(e);return V.length?a("div",null,ce,a("footer",{key:"footer"},V.map((function(e){return a("div",{id:n.slugify(e.identifier),key:e.identifier},e.identifier,ie(X(e.footnote,{inline:!0})))})))):ce}const Qe=e=>{let{children:r,options:o}=e,a=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t.indexOf(r=a[n])>=0||(o[r]=e[r]);return o}(e,n);return t.cloneElement(Ve(r,o),a)};var Je=__webpack_require__(966);function Xe(){return Xe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xe.apply(this,arguments)}var Ye={strings:["These are the default values...","You know what you should do?","Use your own!","Have a great day!"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,smartBackspace:!0,shuffle:!1,backDelay:700,fadeOut:!1,fadeOutClass:"typed-fade-out",fadeOutDelay:500,loop:!1,loopCount:1/0,showCursor:!0,cursorChar:"|",autoInsertCss:!0,attr:null,bindInputFocusEvents:!1,contentType:"html",onBegin:function(e){},onComplete:function(e){},preStringTyped:function(e,t){},onStringTyped:function(e,t){},onLastStringBackspaced:function(e){},onTypingPaused:function(e,t){},onTypingResumed:function(e,t){},onReset:function(e){},onStop:function(e,t){},onStart:function(e,t){},onDestroy:function(e){}},Ze=new(function(){function e(){}var t=e.prototype;return t.load=function(e,t,r){if(e.el="string"==typeof r?document.querySelector(r):r,e.options=Xe({},Ye,t),e.isInput="input"===e.el.tagName.toLowerCase(),e.attr=e.options.attr,e.bindInputFocusEvents=e.options.bindInputFocusEvents,e.showCursor=!e.isInput&&e.options.showCursor,e.cursorChar=e.options.cursorChar,e.cursorBlinking=!0,e.elContent=e.attr?e.el.getAttribute(e.attr):e.el.textContent,e.contentType=e.options.contentType,e.typeSpeed=e.options.typeSpeed,e.startDelay=e.options.startDelay,e.backSpeed=e.options.backSpeed,e.smartBackspace=e.options.smartBackspace,e.backDelay=e.options.backDelay,e.fadeOut=e.options.fadeOut,e.fadeOutClass=e.options.fadeOutClass,e.fadeOutDelay=e.options.fadeOutDelay,e.isPaused=!1,e.strings=e.options.strings.map((function(e){return e.trim()})),e.stringsElement="string"==typeof e.options.stringsElement?document.querySelector(e.options.stringsElement):e.options.stringsElement,e.stringsElement){e.strings=[],e.stringsElement.style.cssText="clip: rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;";var n=Array.prototype.slice.apply(e.stringsElement.children),o=n.length;if(o)for(var a=0;a<o;a+=1)e.strings.push(n[a].innerHTML.trim())}for(var i in e.strPos=0,e.currentElContent=this.getCurrentElContent(e),e.currentElContent&&e.currentElContent.length>0&&(e.strPos=e.currentElContent.length-1,e.strings.unshift(e.currentElContent)),e.sequence=[],e.strings)e.sequence[i]=i;e.arrayPos=0,e.stopNum=0,e.loop=e.options.loop,e.loopCount=e.options.loopCount,e.curLoop=0,e.shuffle=e.options.shuffle,e.pause={status:!1,typewrite:!0,curString:"",curStrPos:0},e.typingComplete=!1,e.autoInsertCss=e.options.autoInsertCss,e.autoInsertCss&&(this.appendCursorAnimationCss(e),this.appendFadeOutAnimationCss(e))},t.getCurrentElContent=function(e){return e.attr?e.el.getAttribute(e.attr):e.isInput?e.el.value:"html"===e.contentType?e.el.innerHTML:e.el.textContent},t.appendCursorAnimationCss=function(e){var t="data-typed-js-cursor-css";if(e.showCursor&&!document.querySelector("["+t+"]")){var r=document.createElement("style");r.setAttribute(t,"true"),r.innerHTML="\n        .typed-cursor{\n          opacity: 1;\n        }\n        .typed-cursor.typed-cursor--blink{\n          animation: typedjsBlink 0.7s infinite;\n          -webkit-animation: typedjsBlink 0.7s infinite;\n                  animation: typedjsBlink 0.7s infinite;\n        }\n        @keyframes typedjsBlink{\n          50% { opacity: 0.0; }\n        }\n        @-webkit-keyframes typedjsBlink{\n          0% { opacity: 1; }\n          50% { opacity: 0.0; }\n          100% { opacity: 1; }\n        }\n      ",document.body.appendChild(r)}},t.appendFadeOutAnimationCss=function(e){var t="data-typed-fadeout-js-css";if(e.fadeOut&&!document.querySelector("["+t+"]")){var r=document.createElement("style");r.setAttribute(t,"true"),r.innerHTML="\n        .typed-fade-out{\n          opacity: 0;\n          transition: opacity .25s;\n        }\n        .typed-cursor.typed-cursor--blink.typed-fade-out{\n          -webkit-animation: 0;\n          animation: 0;\n        }\n      ",document.body.appendChild(r)}},e}()),et=new(function(){function e(){}var t=e.prototype;return t.typeHtmlChars=function(e,t,r){if("html"!==r.contentType)return t;var n=e.substring(t).charAt(0);if("<"===n||"&"===n){var o;for(o="<"===n?">":";";e.substring(t+1).charAt(0)!==o&&!(1+ ++t>e.length););t++}return t},t.backSpaceHtmlChars=function(e,t,r){if("html"!==r.contentType)return t;var n=e.substring(t).charAt(0);if(">"===n||";"===n){var o;for(o=">"===n?"<":"&";e.substring(t-1).charAt(0)!==o&&!(--t<0););t--}return t},e}()),tt=function(){function e(e,t){Ze.load(this,t,e),this.begin()}var t=e.prototype;return t.toggle=function(){this.pause.status?this.start():this.stop()},t.stop=function(){this.typingComplete||this.pause.status||(this.toggleBlinking(!0),this.pause.status=!0,this.options.onStop(this.arrayPos,this))},t.start=function(){this.typingComplete||this.pause.status&&(this.pause.status=!1,this.pause.typewrite?this.typewrite(this.pause.curString,this.pause.curStrPos):this.backspace(this.pause.curString,this.pause.curStrPos),this.options.onStart(this.arrayPos,this))},t.destroy=function(){this.reset(!1),this.options.onDestroy(this)},t.reset=function(e){void 0===e&&(e=!0),clearInterval(this.timeout),this.replaceText(""),this.cursor&&this.cursor.parentNode&&(this.cursor.parentNode.removeChild(this.cursor),this.cursor=null),this.strPos=0,this.arrayPos=0,this.curLoop=0,e&&(this.insertCursor(),this.options.onReset(this),this.begin())},t.begin=function(){var e=this;this.options.onBegin(this),this.typingComplete=!1,this.shuffleStringsIfNeeded(this),this.insertCursor(),this.bindInputFocusEvents&&this.bindFocusEvents(),this.timeout=setTimeout((function(){0===e.strPos?e.typewrite(e.strings[e.sequence[e.arrayPos]],e.strPos):e.backspace(e.strings[e.sequence[e.arrayPos]],e.strPos)}),this.startDelay)},t.typewrite=function(e,t){var r=this;this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor&&this.cursor.classList.remove(this.fadeOutClass));var n=this.humanizer(this.typeSpeed),o=1;!0!==this.pause.status?this.timeout=setTimeout((function(){t=et.typeHtmlChars(e,t,r);var n=0,a=e.substring(t);if("^"===a.charAt(0)&&/^\^\d+/.test(a)){var i=1;i+=(a=/\d+/.exec(a)[0]).length,n=parseInt(a),r.temporaryPause=!0,r.options.onTypingPaused(r.arrayPos,r),e=e.substring(0,t)+e.substring(t+i),r.toggleBlinking(!0)}if("`"===a.charAt(0)){for(;"`"!==e.substring(t+o).charAt(0)&&(o++,!(t+o>e.length)););var s=e.substring(0,t),c=e.substring(s.length+1,t+o),u=e.substring(t+o+1);e=s+c+u,o--}r.timeout=setTimeout((function(){r.toggleBlinking(!1),t>=e.length?r.doneTyping(e,t):r.keepTyping(e,t,o),r.temporaryPause&&(r.temporaryPause=!1,r.options.onTypingResumed(r.arrayPos,r))}),n)}),n):this.setPauseStatus(e,t,!0)},t.keepTyping=function(e,t,r){0===t&&(this.toggleBlinking(!1),this.options.preStringTyped(this.arrayPos,this));var n=e.substring(0,t+=r);this.replaceText(n),this.typewrite(e,t)},t.doneTyping=function(e,t){var r=this;this.options.onStringTyped(this.arrayPos,this),this.toggleBlinking(!0),this.arrayPos===this.strings.length-1&&(this.complete(),!1===this.loop||this.curLoop===this.loopCount)||(this.timeout=setTimeout((function(){r.backspace(e,t)}),this.backDelay))},t.backspace=function(e,t){var r=this;if(!0!==this.pause.status){if(this.fadeOut)return this.initFadeOut();this.toggleBlinking(!1);var n=this.humanizer(this.backSpeed);this.timeout=setTimeout((function(){t=et.backSpaceHtmlChars(e,t,r);var n=e.substring(0,t);if(r.replaceText(n),r.smartBackspace){var o=r.strings[r.arrayPos+1];r.stopNum=o&&n===o.substring(0,t)?t:0}t>r.stopNum?(t--,r.backspace(e,t)):t<=r.stopNum&&(r.arrayPos++,r.arrayPos===r.strings.length?(r.arrayPos=0,r.options.onLastStringBackspaced(),r.shuffleStringsIfNeeded(),r.begin()):r.typewrite(r.strings[r.sequence[r.arrayPos]],t))}),n)}else this.setPauseStatus(e,t,!1)},t.complete=function(){this.options.onComplete(this),this.loop?this.curLoop++:this.typingComplete=!0},t.setPauseStatus=function(e,t,r){this.pause.typewrite=r,this.pause.curString=e,this.pause.curStrPos=t},t.toggleBlinking=function(e){this.cursor&&(this.pause.status||this.cursorBlinking!==e&&(this.cursorBlinking=e,e?this.cursor.classList.add("typed-cursor--blink"):this.cursor.classList.remove("typed-cursor--blink")))},t.humanizer=function(e){return Math.round(Math.random()*e/2)+e},t.shuffleStringsIfNeeded=function(){this.shuffle&&(this.sequence=this.sequence.sort((function(){return Math.random()-.5})))},t.initFadeOut=function(){var e=this;return this.el.className+=" "+this.fadeOutClass,this.cursor&&(this.cursor.className+=" "+this.fadeOutClass),setTimeout((function(){e.arrayPos++,e.replaceText(""),e.strings.length>e.arrayPos?e.typewrite(e.strings[e.sequence[e.arrayPos]],0):(e.typewrite(e.strings[0],0),e.arrayPos=0)}),this.fadeOutDelay)},t.replaceText=function(e){this.attr?this.el.setAttribute(this.attr,e):this.isInput?this.el.value=e:"html"===this.contentType?this.el.innerHTML=e:this.el.textContent=e},t.bindFocusEvents=function(){var e=this;this.isInput&&(this.el.addEventListener("focus",(function(t){e.stop()})),this.el.addEventListener("blur",(function(t){e.el.value&&0!==e.el.value.length||e.start()})))},t.insertCursor=function(){this.showCursor&&(this.cursor||(this.cursor=document.createElement("span"),this.cursor.className="typed-cursor",this.cursor.setAttribute("aria-hidden",!0),this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)))},e}();function rt(e){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(e)}function nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(r),!0).forEach((function(t){var n,o,a;n=e,o=t,a=r[t],o=function(e){var t=function(e,t){if("object"!=rt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=rt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==rt(t)?t:String(t)}(o),o in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var at=function(e){var t={width:9,height:9,margin:"5px 0px 0px 5px",borderRadius:"50%",backgroundColor:"#a3a1a1",opacity:1,animation:"bouncing-loader 0.4s infinite alternate"};return React.createElement(React.Fragment,null,React.createElement("style",null,"\n          @keyframes bouncing-loader {\n            to {\n              opacity: 0.6;\n              transform: translateY(-10px);\n            }\n          }\n        "),React.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:26}},["0.1s","0.2s","0.3s"].map((function(e,r){return React.createElement("div",{key:r,style:ot(ot({},t),{},{animationDelay:e})})}))))},it=__webpack_require__(678),st=__webpack_require__(137),ct=["enabled","content","children","className"];function ut(){return ut=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ut.apply(this,arguments)}function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ft=wp.element,dt=ft.useState,mt=ft.useEffect,ht=ft.useRef,yt=ft.useCallback;const vt=function(e){var t=e.enabled,r=e.content,n=e.children,o=e.className,a=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,ct),i=(0,Je.gR)(),s=lt(dt("idle"),2),c=s[0],u=s[1],l=lt(dt(!0),2),p=l[0],f=l[1],d=ht(null),m=ht(!1),h=yt((function(){m.current||(m.current=!0,d.current=setTimeout((function(){f(!1)}),500))}),[]),y=yt((function(){d.current&&clearTimeout(d.current),f(!0),m.current=!1}),[]);mt((function(){return function(){d.current&&clearTimeout(d.current)}}),[]);var v="success"===c?'<path d="M10.7673 18C10.3106 18 9.86749 17.8046 9.54432 17.4555L5.50694 13.1222C4.83102 12.3968 4.83102 11.2208 5.50694 10.4954C6.18287 9.76997 7.27871 9.76997 7.95505 10.4954L10.6794 13.4196L16.9621 5.63976C17.5874 4.86495 18.6832 4.78289 19.4031 5.45388C20.125 6.12487 20.2036 7.29638 19.5759 8.07391L12.0778 17.3589C11.7639 17.7475 11.3119 17.9801 10.8319 18C10.8087 18 10.788 18 10.7673 18Z" />':"error"===c?'<path d="M17.7623 17.7626C17.0831 18.4418 15.9549 18.416 15.244 17.705L5.79906 8.26012C5.08811 7.54917 5.0623 6.42098 5.74145 5.74183C6.4206 5.06267 7.54879 5.08849 8.25975 5.79944L17.7047 15.2443C18.4156 15.9553 18.4414 17.0835 17.7623 17.7626Z" /><path d="M17.5508 8.52848L8.52842 17.5509C7.84927 18.23 6.72108 18.2042 6.01012 17.4933C5.29917 16.7823 5.27336 15.6541 5.95251 14.975L14.9749 5.95257C15.6541 5.27342 16.7823 5.29923 17.4932 6.01019C18.2042 6.72114 18.23 7.84933 17.5508 8.52848Z" />':'<path d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" />';return React.createElement("div",ut({},a,{onMouseLeave:y,onMouseEnter:h,onMouseOver:h}),React.createElement("span",{className:o},n),React.createElement("div",{className:i("mwai-reply-actions",{"mwai-hidden":p})},t&&React.createElement("div",{className:"mwai-copy-button",onClick:function(){try{navigator.clipboard.writeText(r),u("success")}catch(e){u("error"),console.warn("Not allowed to copy to clipboard. Make sure your website uses HTTPS.",{content:r})}finally{setTimeout((function(){u("idle")}),2e3)}}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",dangerouslySetInnerHTML:{__html:v}}))))};function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var bt=wp.element.useMemo;const _t=function(t){var r=t.role,n=void 0===r?"user":r,o=(0,e.o)().state,a=o.pluginUrl,i=o.iconUrl,s=o.userData,c=o.userName,u=o.aiName,l=o.guestName,p=o.userAvatar,f=o.aiAvatar,d=o.guestAvatar,m=o.userAvatarUrl,h=o.aiAvatarUrl,y=o.guestAvatarUrl,v=bt((function(){var e="assistant"===n,t=!s&&!e,r=function(e){return React.createElement("div",{className:"mwai-name-text"},e)},o=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!e)return null;if((0,it.Ve)(t))return o=t,React.createElement("div",{className:"mwai-avatar mwai-emoji",style:{fontSize:"32px",lineHeight:"32px"}},o);var s=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,Je.mv)(e)?e:e&&!(0,it.Ve)(e)?t?e:"".concat(a,"/images/").concat(e):(t||(0,it.Ve)(e)||console.warn("Invalid URL for avatar:",e),null)}(t,i)||r;return s?function(e,t){return React.createElement("div",{className:"mwai-avatar"},React.createElement("img",{width:"32",height:"32",src:e,alt:t}))}(s,n):null};if(e){var v=o(f,h,i,"AI Avatar");return v?(null===h&&i&&console.warn("Using iconUrl as a temporary fallback for AI avatar. Please set aiAvatarUrl."),v):r(u)}return t?t?o(d,y,null,"Guest Avatar")||r(l||"Guest"):void 0:o(p,m,null==s?void 0:s.AVATAR_URL,"User Avatar",!0)||r(function(e,t,r){return r&&0!==Object.keys(r).length?Object.entries(r).reduce((function(e,t){var r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),n=r[0],o=r[1],a="{".concat(n,"}");return e.includes(a)?e.replace(a,o):e}),e):t||e||"Guest"}(c,l,s))}),[n,u,c,l,s,i,f,p,d,h,m,y,a]);return React.createElement("span",{className:"mwai-name"},v)};function wt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return St(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?St(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xt=wp.element,Et=xt.useState,kt=xt.useMemo,Ot=xt.useEffect,It=xt.useRef,At=function(e){var t=e.href,r=e.children;if(!t)return React.createElement("span",null,r);var n=window.location.hostname,o="_self";try{o=n===new URL(t,window.location.href).hostname?"_self":"_blank"}catch(e){console.error("Invalid URL:",e),o="_blank"}if("Uploaded File"===String(r)){var a=t.split("/").pop();return React.createElement("a",{href:t,target:o,rel:"noopener noreferrer",className:"mwai-filename"},React.createElement("span",null,"✓ ",a))}return React.createElement("a",{href:t,target:o,rel:"noopener noreferrer"},r)},Rt=function(t){var r,n=t.message,o=t.onRendered,a=void 0===o?function(){}:o,i=(0,e.o)().state.copyButton,s=wt(Et(n.isQuerying||n.isStreaming),1)[0],c=n.isQuerying,u=n.isStreaming,l=null!==(r=n.content)&&void 0!==r?r:"";(l.match(/```/g)||[]).length%2!=0?l+="\n```":n.isStreaming&&(l+="<BlinkingCursor />"),Ot((function(){s&&(!s||c||u)||a()}),[s,c,u]);var p=kt((function(){var e={overrides:{BlinkingCursor:{component:it.rn},a:{component:At},img:{props:{onError:function(e){null!==e.target.src.match(/\.(jpeg|jpg|gif|png)$/)&&(e.target.src="https://placehold.co/600x200?text=Expired+Image")},className:"mwai-image"}}}};return e}),[]);return c||u&&!l?React.createElement(at,null):React.createElement(React.Fragment,null,React.createElement(_t,{role:n.role}),React.createElement(vt,{content:n.content,enabled:i,className:"mwai-text"},React.createElement(Qe,{options:p},l)))},Ct=function(e){var t=e.message,r=e.onRendered,n=void 0===r?function(){}:r,o=wt(Et(null==t?void 0:t.images),2),a=o[0],i=o[1];return Ot((function(){n()})),t.isQuerying?React.createElement(at,null):React.createElement(React.Fragment,null,React.createElement(_t,{role:t.role}),React.createElement("span",{className:"mwai-text"},React.createElement("div",{className:"mwai-gallery"},null==a?void 0:a.map((function(e,t){return React.createElement("a",{key:t,href:e,target:"_blank",rel:"noopener noreferrer"},React.createElement("img",{key:t,src:e,onError:function(){return function(e){i((function(t){return t.map((function(t,r){return r===e?"https://placehold.co/600x200?text=Expired+Image":t}))}))}(t)}}))})))))},Tt=function(e){var t=e.message,r=e.conversationRef,n=e.onRendered,o=void 0===n?function(){}:n,a=It(null),i=wt(Et(t.isQuerying),1)[0],s=wt(Et(!t.isQuerying),2),c=s[0],u=s[1],l=t.content;return Ot((function(){console.warn("Do not use the Typewriter Effect. Use Streaming instead.")}),[]),(0,Je.$$)(200,(function(){null!=r&&r.current}),!c),Ot((function(){if(i){if(a.current){var e={strings:[l],typeSpeed:(0,st.W5)("typewriter.speed",15),showCursor:!1,onComplete:function(e){e.cursor&&e.cursor.remove(),o(),u((function(){return!0}))}},t=new tt(a.current,e);return function(){t.destroy()}}}else o()}),[t,t.isQuerying]),React.createElement(React.Fragment,null,t.isQuerying&&React.createElement(at,null),!t.isQuerying&&i&&React.createElement(React.Fragment,null,React.createElement(_t,{role:t.role}),React.createElement("span",{className:"mwai-text",ref:a})),!t.isQuerying&&!i&&React.createElement(React.Fragment,null,React.createElement(_t,{role:t.role}),React.createElement("span",{className:"mwai-text"},React.createElement(Qe,null,l))))};const Pt=function(t){var r,n=t.message,o=t.conversationRef,a=(0,e.o)().state.typewriter,i=(0,Je.gR)(),s=It(),c=i("mwai-reply",{"mwai-ai":"assistant"===n.role,"mwai-user":"user"===n.role,"mwai-system":"system"===n.role}),u=(null==n||null===(r=n.images)||void 0===r?void 0:r.length)>0,l=function(){s.current&&(n.isQuerying||s.current.classList.contains("mwai-rendered")||"undefined"!=typeof hljs&&(s.current.classList.add("mwai-rendered"),s.current.querySelectorAll("pre code").forEach((function(e){hljs.highlightElement(e)}))))};return kt((function(){return"user"===n.role?React.createElement("div",{ref:s,className:c},React.createElement(Rt,{message:n})):"assistant"===n.role?u?React.createElement("div",{ref:s,className:c},React.createElement(Ct,{message:n,conversationRef:o,onRendered:l})):a&&!n.isStreaming?(console.warn("The Typewriter effect is deprecated. Use Streaming instead."),React.createElement("div",{ref:s,className:c},React.createElement(Tt,{message:n,conversationRef:o,onRendered:l}))):React.createElement("div",{ref:s,className:c},React.createElement(Rt,{message:n,conversationRef:o,onRendered:l})):"system"===n.role?React.createElement("div",{ref:s,className:c},React.createElement(Rt,{message:n,conversationRef:o,onRendered:l})):React.createElement("div",null,React.createElement("i",null,"Unhandled role."))}),[n,o,u,a])};function jt(){return jt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jt.apply(this,arguments)}const Lt=t.useLayoutEffect;var Mt=function(e,t){"function"!=typeof e?e.current=t:e(t)};var Nt={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},Ft=function(e){Object.keys(Nt).forEach((function(t){e.style.setProperty(t,Nt[t],"important")}))},Ut=null,Dt=function(e,t){var r=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?r+t.borderSize:r-t.paddingSize},Bt=function(){},$t=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],Wt=!!document.documentElement.currentStyle;function Ht(e,r,n){var o,a,i=(o=n,a=t.useRef(o),Lt((function(){a.current=o})),a);t.useLayoutEffect((function(){var t=function(e){return i.current(e)};if(e)return e.addEventListener(r,t),function(){return e.removeEventListener(r,t)}}),[])}var Kt=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],zt=function(e,r){var n,o=e.cacheMeasurements,a=e.maxRows,i=e.minRows,s=e.onChange,c=void 0===s?Bt:s,u=e.onHeightChange,l=void 0===u?Bt:u,p=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,Kt),f=void 0!==p.value,d=t.useRef(null),m=function(e,r){var n=(0,t.useRef)();return(0,t.useCallback)((function(t){e.current=t,n.current&&Mt(n.current,null),n.current=r,r&&Mt(r,t)}),[r])}(d,r),h=t.useRef(0),y=t.useRef(),v=function(){var e=d.current,t=o&&y.current?y.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var r,n=(r=t,$t.reduce((function(e,t){return e[t]=r[t],e}),{})),o=n.boxSizing;return""===o?null:(Wt&&"border-box"===o&&(n.width=parseFloat(n.width)+parseFloat(n.borderRightWidth)+parseFloat(n.borderLeftWidth)+parseFloat(n.paddingRight)+parseFloat(n.paddingLeft)+"px"),{sizingStyle:n,paddingSize:parseFloat(n.paddingBottom)+parseFloat(n.paddingTop),borderSize:parseFloat(n.borderBottomWidth)+parseFloat(n.borderTopWidth)})}(e);if(t){y.current=t;var r=function(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=1/0),Ut||((Ut=document.createElement("textarea")).setAttribute("tabindex","-1"),Ut.setAttribute("aria-hidden","true"),Ft(Ut)),null===Ut.parentNode&&document.body.appendChild(Ut);var o=e.paddingSize,a=e.borderSize,i=e.sizingStyle,s=i.boxSizing;Object.keys(i).forEach((function(e){var t=e;Ut.style[t]=i[t]})),Ft(Ut),Ut.value=t;var c=Dt(Ut,e);Ut.value=t,c=Dt(Ut,e),Ut.value="x";var u=Ut.scrollHeight-o,l=u*r;"border-box"===s&&(l=l+o+a),c=Math.max(l,c);var p=u*n;return"border-box"===s&&(p=p+o+a),[c=Math.min(p,c),u]}(t,e.value||e.placeholder||"x",i,a),n=r[0],s=r[1];h.current!==n&&(h.current=n,e.style.setProperty("height",n+"px","important"),l(n,{rowHeight:s}))}};return t.useLayoutEffect(v),Ht(window,"resize",v),n=v,Ht(document.fonts,"loadingdone",n),t.createElement("textarea",jt({},p,{onChange:function(e){f||v(),c(e)},ref:m}))},Gt=t.forwardRef(zt);function qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Vt=wp.element,Qt=Vt.useState,Jt=Vt.useMemo,Xt=Vt.useRef;const Yt=function(){var t=(0,Je.gR)(),r=(0,e.o)(),n=r.state,o=r.actions,a=n.uploadedFile,i=n.busy,s=n.imageUpload,c=n.fileSearch,u=n.draggingType,l=o.onUploadFile,p=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return qt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Qt(!1),2),f=p[0],d=p[1],m=Xt(),h=null==a?void 0:a.uploadedId,y=s||c,v=a,g=Jt((function(){return null!=v&&v.localFile?v.localFile.type.startsWith("image/")?"image":"document":u}),[v,u]),b=Jt((function(){var e="idle";null!=v&&v.uploadProgress?e="up":u?e="add":f&&h?e="del":h?e="ok":f&&!h&&(e="add");var t=g?g.toLowerCase():"idle";return"mwai-file-upload-icon mwai-".concat(t,"-").concat(e)}),[g,v,u,f,h]),_=Jt((function(){return null!=v&&v.uploadProgress?v.uploadProgress>99?99:Math.round(v.uploadProgress):""}),[v]);return y?React.createElement("div",{disabled:i,onClick:function(){null!=a&&a.localFile?l(null):i||m.current.click()},onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)},className:t("mwai-file-upload",{"mwai-enabled":null==a?void 0:a.uploadedId,"mwai-busy":(null==a?void 0:a.localFile)&&!(null!=a&&a.uploadedId)}),style:{cursor:i?"default":"pointer"}},React.createElement("div",{className:b},React.createElement("span",{className:"mwai-file-upload-progress"},_)),React.createElement("input",{type:"file",ref:m,onChange:function(e){var t=e.target.files[0];t&&l(t)},style:{display:"none"}})):null};function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var er=wp.element,tr=er.useRef,rr=er.useState,nr=er.useEffect,or=er.useImperativeHandle;const ar=function(){var t=(0,Je.gR)(),r=(0,e.o)(),n=r.state,o=r.actions,a=n.inputText,i=n.textInputMaxLength,s=n.textInputPlaceholder,c=n.error,u=n.speechRecognitionAvailable,l=n.isMobile,p=n.conversationRef,f=n.open,d=n.uploadIconPosition,m=n.locked,h=n.isListening,y=n.busy,v=n.speechRecognition,g=n.chatbotInputRef,b=o.onSubmitAction,_=o.setIsListening,w=o.resetError,S=o.setInputText,x=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Zt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(rr(!1),2),E=x[0],k=x[1],O=tr();or(g,(function(){return{focusInput:function(){var e;null===(e=O.current)||void 0===e||e.focus()},currentElement:function(){return O.current}}})),nr((function(){!l&&f&&O.current.focus(),p.current&&(p.current.scrollTop=p.current.scrollHeight)}),[f,l,p]);var I=t("mwai-input-text",{});return React.createElement("div",{ref:g,className:I},"mwai-input"===d&&React.createElement(Yt,null),React.createElement(Gt,{ref:O,disabled:y||m,placeholder:s,value:a,maxLength:i,onCompositionStart:function(){return k(!0)},onCompositionEnd:function(){return k(!1)},onKeyDown:function(e){E||"Enter"!==e.code||e.shiftKey||(e.preventDefault(),b())},onChange:function(e){return t=e.target.value,h&&_(!1),c&&w(),void S(t);var t}}),v&&React.createElement(Je.tm,{active:h,disabled:!u||y,className:"mwai-microphone",onClick:function(){return _(!h)}}))};var ir=wp.element,sr=ir.useMemo,cr=ir.useCallback;const ur=function(){var t=(0,e.o)(),r=t.state,n=t.actions,o=n.onClear,a=n.onSubmitAction,i=n.setIsListening,s=r.textClear,c=r.textSend,u=r.uploadedFile,l=r.inputText,p=r.messages,f=r.isListening,d=r.timeElapsed,m=r.busy,h=r.submitButtonConf,y=r.locked,v=!(null==u||!u.uploadProgress),g=!(null!=u&&u.uploadedId)&&l.length<1&&(null==p?void 0:p.length)>1,b=sr((function(){return m?d?React.createElement("div",{className:"mwai-timer"},d):null:null!=h&&h.imageSend&&null!=h&&h.imageClear?React.createElement("img",{src:g?h.imageClear:h.imageSend,alt:g?s:c}):React.createElement("span",null,g?s:c)}),[m,d,g,s,c,h]),_=sr((function(){return"mwai-input-submit ".concat(m?"mwai-busy":"")}),[m]),w=cr((function(){f&&i(!1),g?o():a()}),[g,f,o,a,i]),S=cr((function(){m||w()}),[m,w]);return React.createElement("button",{className:_,disabled:m||v||y,onClick:S},b)};var lr=wp.element.useMemo;const pr=function(){var t=(0,e.o)(),r=t.state,n=t.actions,o=r.theme,a=r.isWindow,i=r.fullscreen,s=r.aiName,c=r.pluginUrl,u=r.open,l=r.iconUrl,p=r.aiAvatarUrl,f=r.windowed,d=n.setOpen,m=n.setWindowed,h=lr((function(){if(!a)return null;var e="timeless"===(null==o?void 0:o.themeId),t=e?function(e,t,r,n){var o;if((0,it.Ve)(n||r))return o=n||r,React.createElement("div",{className:"mwai-avatar mwai-emoji",style:{fontSize:"48px",lineHeight:"48px"}},o);var a,i,s=(a=n,((0,Je.mv)(a)?a:a?"".concat(t,"/images/").concat(a):null)||r||"".concat(t,"/images/chat-openai.svg"));return s?(i=s,"AI Engine",React.createElement("div",{className:"mwai-avatar"},React.createElement("img",{alt:"AI Engine",src:i}))):React.createElement("div",{className:"mwai-name-text"},e)}(s,c,l,p):null;return React.createElement(React.Fragment,null,e&&React.createElement(React.Fragment,null,t,React.createElement("div",{className:"mwai-name"},React.createElement("small",null,"Discuss with"),React.createElement("div",null,s)),React.createElement("div",{style:{flex:"auto"}})),React.createElement("div",{className:"mwai-buttons"},i&&React.createElement("div",{className:"mwai-resize-button",onClick:function(){return m(!f)}}),React.createElement("div",{className:"mwai-close-button",onClick:function(){return d(!u)}})))}),[a,null==o?void 0:o.themeId,s,c,l,p,i,m,f,d,u]);return React.createElement("div",{className:"mwai-header"},h)};var fr=wp.element,dr=fr.useMemo,mr=fr.useEffect;const hr=function(){var t=(0,e.o)(),r=t.state,n=t.actions,o=r.isWindow,a=r.iconText,i=r.showIconMessage,s=r.iconAlt,c=r.iconUrl,u=r.open,l=n.setShowIconMessage,p=n.setOpen;mr((function(){u&&i&&l(!1)}),[u,l,i]);var f=dr((function(){return o?React.createElement("div",{className:"mwai-trigger mwai-open-button"},React.createElement(Je.bE,{className:"mwai-icon-text-container",if:a&&i},React.createElement("div",{className:"mwai-icon-text-close",onClick:function(){return l(!1)}},"✕"),React.createElement("div",{className:"mwai-icon-text",onClick:function(){return p(!0)}},a)),React.createElement("div",{className:"mwai-icon-container",onClick:function(){return p(!0)}},(0,it.Ve)(c)?React.createElement("div",{className:"mwai-icon mwai-emoji",style:{fontSize:"48px",lineHeight:"64px",width:"64px",height:"64px",display:"flex",justifyContent:"center",alignItems:"center"}},c):React.createElement("img",{className:"mwai-icon",width:"64",height:"64",alt:s,src:c}))):null}),[o,a,i,s,c,l,p]);return React.createElement(React.Fragment,null,f)};function yr(e){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yr(e)}function vr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(r),!0).forEach((function(t){br(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function br(e,t,r){return t=function(e){var t=function(e,t){if("object"!=yr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==yr(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var wr=wp.element,Sr=wr.useState,xr=wr.useMemo,Er=wr.useLayoutEffect,kr=wr.useCallback,Or=wr.useEffect,Ir=wr.useRef,Ar={overrides:{a:{props:{target:"_blank"}}}};const Rr=function(t){var r=(0,Je.gR)(),n=t.style,o=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _r(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Sr(!0),2),a=o[0],i=o[1],s=(0,e.o)(),c=s.state,u=s.actions,l=c.theme,p=c.botId,f=c.customId,d=c.messages,m=c.textCompliance,h=c.isWindow,y=c.fullscreen,v=c.iconPosition,g=c.iconBubble,b=c.shortcuts,_=c.blocks,w=c.imageUpload,S=c.fileSearch,x=c.draggingType,E=c.isBlocked,k=c.virtualKeyboardFix,O=c.windowed,I=c.cssVariables,A=c.error,R=c.conversationRef,C=c.open,T=c.busy,P=c.uploadIconPosition,j=u.resetError,L=u.onSubmit,M=u.setIsBlocked,N=u.setDraggingType,F=u.onUploadFile,U=xr((function(){return"css"===(null==l?void 0:l.type)?null==l?void 0:l.style:null}),[l]),D=w||S,B=D||m,$=Ir(null),W=(0,Je.kW)(),H=W.viewportHeight,K=W.isIOS,z=W.isAndroid;Or((function(){if(k&&(K||z)&&h){var e=document.querySelector(".mwai-window");e&&(C?(e.style.height="".concat(H,"px"),K&&function(){if("INPUT"===document.activeElement.tagName||"TEXTAREA"===document.activeElement.tagName){window.scrollTo({top:0});var e=setInterval((function(){window.scrollTo({top:0})}),100);setTimeout((function(){clearInterval(e)}),1e3)}}()):e.style.height="")}}),[y,z,K,h,O,C,H,k]);var G=r("mwai-chatbot",br(br(br(br(br(br(br(br({},"mwai-".concat(null==l?void 0:l.themeId,"-theme"),!0),"mwai-window",h),"mwai-bubble",g),"mwai-open",C),"mwai-fullscreen",!O||!h&&y),"mwai-bottom-left","bottom-left"===v),"mwai-top-right","top-right"===v),"mwai-top-left","top-left"===v));Er((function(){a&&R.current&&(R.current.scrollTop=R.current.scrollHeight)}),[d,a,R,T]);var q=Ir(new Set);Or((function(){_&&_.length>0&&_.forEach((function(e){var t=e.type,r=e.data;"content"===t&&r.script&&function(e){var t=function(e){var t,r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return r}(e);if(!q.current.has(t)){var r=document.createElement("script");r.type="text/javascript",r.textContent=e,document.body.appendChild(r),q.current.add(t)}}(r.script)}))}),[_]);var V=xr((function(){return null==d?void 0:d.map((function(e){return React.createElement(Pt,{key:e.id,message:e})}))}),[d]),Q=xr((function(){return b&&0!==b.length?React.createElement("div",{className:"mwai-shortcuts"},b.map((function(e,t){var n=e.type,o=e.data;if("message"!==n)return console.warn("This shortcut type is not supported: ".concat(n,".")),null;var a=o.label,i=o.message,s=o.variant,c=r("mwai-shortcut",{"mwai-success":"success"===s,"mwai-danger":"danger"===s,"mwai-warning":"warning"===s,"mwai-info":"info"===s});return React.createElement("button",{className:c,key:t,onClick:function(){L(i)}},a||"N/A")}))):null}),[r,L,b]),J=xr((function(){return _&&0!==_.length?React.createElement("div",{className:"mwai-blocks"},_.map((function(e,t){var n=e.type,o=e.data;if("content"!==n)return console.warn("Block type ".concat(n," is not supported.")),null;var a=o.html,i=o.variant,s=r("mwai-block",{"mwai-success":"success"===i,"mwai-danger":"danger"===i,"mwai-warning":"warning"===i,"mwai-info":"info"===i});return React.createElement("div",{className:s,key:t,dangerouslySetInnerHTML:{__html:a}})}))):null}),[r,_]),X=kr((function(e,t){e.preventDefault(),e.stopPropagation();var r=e.dataTransfer.items[0];t?($.current&&(clearTimeout($.current),$.current=null),w&&function(e){return e.type.startsWith("image/")}(r)?(N("image"),M(!1)):S&&function(e){return["text/x-c","text/x-csharp","text/x-c++","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/html","text/x-java","application/json","text/markdown","application/pdf","text/x-php","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-python","text/x-script.python","text/x-ruby","text/x-tex","text/plain","text/css","text/javascript","application/x-sh","application/typescript"].includes(e.type)}(r)?(N("document"),M(!1)):(N(!1),M(!0))):$.current||($.current=setTimeout((function(){N(!1),M(!1),$.current=null}),100))}),[w,S]),Y=kr((function(e){if(e.preventDefault(),X(e,!1),!T){var t=e.dataTransfer.files[0];t&&("image"===x&&w||"document"===x&&S?F(t):(M(!0),setTimeout((function(){return M(!1)}),2e3)))}}),[T,x,w,S,F]),Z=r("mwai-input",{"mwai-dragging":x,"mwai-blocked":E});return React.createElement(Je.bE,{id:"mwai-chatbot-".concat(f||p),className:G,style:gr(gr({},I),n),if:!0,disableTransition:!h},U&&React.createElement("style",null,U),React.createElement(hr,null),React.createElement(pr,null),React.createElement("div",{className:"mwai-content"},React.createElement("div",{ref:R,className:"mwai-conversation",onScroll:function(){if(R.current){var e=R.current,t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;i(r-t<=n+1)}}},V,Q),A&&React.createElement("div",{className:"mwai-error",onClick:function(){return j()}},React.createElement(Qe,{options:Ar},A)),J,React.createElement("div",{className:Z,onDrop:Y,onDragEnter:function(e){return X(e,!0)},onDragLeave:function(e){return X(e,!1)},onDragOver:function(e){return X(e,!0)}},React.createElement(ar,null),React.createElement(ur,null)),B&&React.createElement("div",{className:"mwai-footer"},D&&React.createElement("div",{className:"mwai-tools"},"mwai-tools"===P&&React.createElement(Yt,null)),m&&React.createElement("div",{className:"mwai-compliance",dangerouslySetInnerHTML:{__html:m}}))))},Cr=function(t){return React.createElement(e.G,t,React.createElement(Rr,t))};var Tr=__webpack_require__(296);function Pr(e){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pr(e)}var jr=["children"];function Lr(){Lr=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),s=new C(n||[]);return o(i,"_invoke",{value:O(e,r,s)}),i}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",m="executing",h="completed",y={};function v(){}function g(){}function b(){}var _={};u(_,i,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(T([])));S&&S!==r&&n.call(S,i)&&(_=S);var x=b.prototype=v.prototype=Object.create(_);function E(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(o,a,i,s){var c=p(e[o],e,a);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Pr(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function O(t,r,n){var o=f;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=I(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=p(t,r,n);if("normal"===u.type){if(o=n.done?h:d,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=h,n.method="throw",n.arg=u.arg)}}}function I(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var a=p(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,y;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function T(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Pr(t)+" is not iterable")}return g.prototype=b,o(x,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},E(k.prototype),u(k.prototype,s,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(l(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(x),u(x,c,"Generator"),u(x,i,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=T,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:T(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function Mr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Nr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(r),!0).forEach((function(t){var n,o,a;n=e,o=t,a=r[t],o=function(e){var t=function(e,t){if("object"!=Pr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Pr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Pr(t)?t:String(t)}(o),o in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Fr(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function Ur(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Fr(a,n,o,i,s,"next",e)}function s(e){Fr(a,n,o,i,s,"throw",e)}i(void 0)}))}}function Dr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Br(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Br(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Br(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $r=wp.element,Wr=$r.useContext,Hr=$r.createContext,Kr=$r.useState,zr=$r.useMemo,Gr=$r.useEffect,qr=$r.useCallback,Vr=Hr(),Qr=function(e){var t=e.children,r=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,jr),n=r.system,o=r.theme,a=Dr(Kr([]),2),i=a[0],s=a[1],c=Dr(Kr(null),2),u=c[0],l=c[1],p=Dr(Kr(!1),2),f=p[0],d=p[1],m=zr((function(){return(null==o?void 0:o.settings)||{}}),[o]),h=n.botId,y=n.customId,v=n.restNonce,g=n.pluginUrl,b=n.restUrl,_=n.debugMode,w=zr((function(){return Object.keys(m).reduce((function(e,t){return e["--mwai-".concat(t)]=m[t],e}),{})}),[m]),S=qr(Ur(Lr().mark((function e(){var t,r,n,o,a,i=arguments;return Lr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]&&i[0],e.prev=1,t||d(!0),r={botId:h||y},_&&console.log("[DISCUSSIONS] OUT: ",r),e.next=7,fetch("".concat(b,"/mwai-ui/v1/discussions/list"),{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":v},body:(0,Tr.F1)(r)});case 7:return n=e.sent,e.next=10,n.json();case 10:if((o=e.sent).success){e.next=13;break}throw new Error("Could not retrieve the discussions: ".concat(o.message));case 13:_&&console.log("[DISCUSSIONS] IN: ",o),a=o.chats.map((function(e){var t=JSON.parse(e.messages),r=JSON.parse(e.extra);return Nr(Nr({},e),{},{messages:t,extra:r})})),s(a),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.error(e.t0);case 21:return e.prev=21,t||d(!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[1,18,21,24]])}))),[]);Gr((function(){S();var e=setInterval((function(){S(!0)}),5e3);return function(){return clearInterval(e)}}),[]);var x=function(e){var t=MwaiAPI.getChatbot(e);if(!t)throw new Error("Chatbot not found.",{botId:e,chatbots:MwaiAPI.chatbots});return t},E=function(){var e=Ur(Lr().mark((function e(t){var r;return Lr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.find((function(e){return e.chatId===t})),r){e.next=4;break}return console.error("Discussion not found.",{chatId:t,discussions:i}),e.abrupt("return");case 4:x(h).setContext({chatId:t,messages:r.messages}),l(r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Ur(Lr().mark((function e(){return Lr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x(h).clear();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O={onDiscussionClick:E,onNewChatClick:k},I={botId:h,pluginUrl:g,busy:f,setBusy:d,cssVariables:w,discussions:i,discussion:u,theme:o};return React.createElement(Vr.Provider,{value:{state:I,actions:O}},t)};function Jr(e){return Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jr(e)}function Xr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xr(Object(r),!0).forEach((function(t){Zr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Zr(e,t,r){return t=function(e){var t=function(e,t){if("object"!=Jr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Jr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Jr(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var en=wp.element,tn=en.useMemo,rn=en.useEffect,nn=function(e){var t=e.discussion,r=e.onClick,n=void 0===r?function(){}:r,o=e.selected,a=void 0!==o&&o,i=(0,Je.gR)(),s=t.messages,c=s[s.length-1],u=c.content.length>64?c.content.substring(0,64)+"...":c.content,l=i("mwai-discussion",{"mwai-active":a});return React.createElement("li",{className:l,onClick:n},u)};const on=function(e){var t=e.theme,r=e.style,n=e.params,o=(0,Je.gR)(),a=tn((function(){return"css"===(null==t?void 0:t.type)?null==t?void 0:t.style:null}),[t]),i=function(){var e=Wr(Vr);if(!e)throw new Error("useDiscussionsContext must be used within a DiscussionsContextProvider");return e}(),s=i.state,c=i.actions,u=s.botId,l=s.cssVariables,p=s.discussions,f=s.discussion,d=s.busy,m=c.onDiscussionClick,h=c.onNewChatClick,y=n.textNewChat;rn((function(){}));var v=o("mwai-discussions",Zr({},"mwai-".concat(null==t?void 0:t.themeId,"-theme"),!0));return React.createElement(React.Fragment,null,React.createElement("div",{id:"mwai-discussions-".concat(u),className:v,style:Yr(Yr({},l),r)},a&&React.createElement("style",null,a),React.createElement("div",{className:o("mwai-header")},React.createElement("button",{onClick:function(){return h()},disabled:d},React.createElement("span",null,null!=y?y:"+ New chat"))),React.createElement("ul",{className:o("mwai-content")},p.map((function(e){return React.createElement(nn,{key:e.id,discussion:e,selected:(null==f?void 0:f.id)===e.id,onClick:function(){return m(e.chatId)}})})))))},an=function(e){return React.createElement(Qr,e,React.createElement(on,e))};var sn=wp.element.render;function cn(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}document.addEventListener("DOMContentLoaded",(function(){function e(e,t){e.forEach((function(e){var r=JSON.parse(cn(e.getAttribute("data-params"))),n=JSON.parse(cn(e.getAttribute("data-system"))),o=JSON.parse(cn(e.getAttribute("data-theme")));e.removeAttribute("data-params"),e.removeAttribute("data-system"),e.removeAttribute("data-theme"),sn(t({system:n,params:r,theme:o}),e)}))}e(document.querySelectorAll(".mwai-chatbot-container"),Cr),e(document.querySelectorAll(".mwai-discussions-container"),an)}))})()})();